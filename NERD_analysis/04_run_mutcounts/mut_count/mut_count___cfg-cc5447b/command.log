################################################################################
# 3 - Verify FASTQ inputs
################################################################################
-rw-r--r-- 1 ekc5108 b1044 5.6M Sep 17  2024 /projects/b1044/Sequencing/SHAPE-Seq/EKC/230617_M05164_0145_000000000-L4LWB/031-EKC-A8C-75c-b-1-p_S31_L001_R1_001.fastq.gz
-rw-r--r-- 1 ekc5108 b1044 8.0M Sep 17  2024 /projects/b1044/Sequencing/SHAPE-Seq/EKC/230617_M05164_0145_000000000-L4LWB/031-EKC-A8C-75c-b-1-p_S31_L001_R2_001.fastq.gz
################################################################################
# 4 - Verify created FASTA
################################################################################
>031-EKC-A8C-75c-b-1-p
ggtgtaagggtgaagtgtaAGGTTGACCTTTTGAATAGTGATTCAGGAGGTTAATGGAAGtaaaggtaatgaaggtgaag
################################################################################
# 5 - Create shapemapper
################################################################################
Command: /projects/b1044/Software/shapemapper2-2.3/shapemapper --name 031-EKC-A8C-75c-b-1-p --target artifacts/031-EKC-A8C-75c-b-1-p/target.fa --out artifacts/031-EKC-A8C-75c-b-1-p --modified --R1 /projects/b1044/Sequencing/SHAPE-Seq/EKC/230617_M05164_0145_000000000-L4LWB/031-EKC-A8C-75c-b-1-p_S31_L001_R1_001.fastq.gz --R2 /projects/b1044/Sequencing/SHAPE-Seq/EKC/230617_M05164_0145_000000000-L4LWB/031-EKC-A8C-75c-b-1-p_S31_L001_R2_001.fastq.gz --amplicon --dms --N7 --bypass_filters --per-read-histograms
################################################################################
# 6 - Run shapemapper
################################################################################

################################################################################

Started ShapeMapper v2.3.0 at 2025-10-14 17:51:26
Output will be logged to 031-EKC-A8C-75c-b-1-p_shapemapper_log.txt
Running from directory: /gpfs/projects/b1044/Computational_Output/EKC/EKC.01_SHAPE_standardization/EKC.01.065.refactoring_data_analysis/nerd/examples/all_mutcounts/mut_count/mut_count___cfg-cc5447b
args:  --name 031-EKC-A8C-75c-b-1-p --target artifacts/031-EKC-A8C-75c-b-1-p/target.fa --out artifacts/031-EKC-A8C-75c-b-1-p --modified --R1 /projects/b1044/Sequencing/SHAPE-Seq/EKC/230617_M05164_0145_000000000-L4LWB/031-EKC-A8C-75c-b-1-p_S3... --R2 /projects/b1044/Sequencing/SHAPE-Seq/EKC/230617_M05164_0145_000000000-L4LWB/031-EKC-A8C-75c-b-1-p_S3... --amplicon --dms --N7 --bypass_filters --per-read-histograms
--bypass_filters flag passed - ignoring low N7 reactivity and setting per-NT threshold to 1.
Using default DMS max-bg of 0.02
	You can manually override using the max-bg flag
Created pipeline at 2025-10-14 17:51:26
Running PrimerLocator at 2025-10-14 17:51:26 . . .
. . . done at 2025-10-14 17:51:27
Running FastaFormatChecker at 2025-10-14 17:51:27 . . .
. . . done at 2025-10-14 17:51:27
Running BowtieIndexBuilder at 2025-10-14 17:51:27 . . .
. . . done at 2025-10-14 17:51:27
Running process group 4 at 2025-10-14 17:51:27 . . .
  Including these components:
    ProgressMonitor . . . started at 2025-10-14 17:51:27
    QualityTrimmer1 . . . started at 2025-10-14 17:51:27
    QualityTrimmer2 . . . started at 2025-10-14 17:51:27
    Interleaver . . . started at 2025-10-14 17:51:27
    Merger . . . started at 2025-10-14 17:51:27
    Tab6Interleaver . . . started at 2025-10-14 17:51:27
    BowtieAligner . . . started at 2025-10-14 17:51:27
    MutationParser_Modified . . . started at 2025-10-14 17:51:27
    MutationParserGA_Modified . . . started at 2025-10-14 17:51:27
    MutationCounter_Modified . . . started at 2025-10-14 17:51:27
    MutationCounterGA_Modified . . . started at 2025-10-14 17:51:27
  796KiB [=====>                                          ] 13% ETA 0:00:06       1.09MiB [========>                                       ] 19% ETA 0:00:121.11MiB [========>                                       ] 19% ETA 0:00:12  1.40MiB [===========>                                    ] 25% ETA 0:00:11      1.78MiB [=============>                                  ] 31% ETA 0:00:10      2.07MiB [================>                               ] 37% ETA 0:00:112.14MiB [=================>                              ] 38% ETA 0:00:11  2.41MiB [===================>                            ] 43% ETA 0:00:10      2.77MiB [======================>                         ] 49% ETA 0:00:10      3.00MiB [========================>                       ] 53% ETA 0:00:093.00MiB [========================>                       ] 53% ETA 0:00:09  3.34MiB [===========================>                    ] 59% ETA 0:00:123.35MiB [===========================>                    ] 59% ETA 0:00:12  3.64MiB [=============================>                  ] 64% ETA 0:00:10      3.91MiB [================================>               ] 69% ETA 0:00:09      4.11MiB [==================================>             ] 73% ETA 0:00:07      4.23MiB [===================================>            ] 75% ETA 0:00:074.24MiB [===================================>            ] 75% ETA 0:00:07  4.57MiB [=====================================>          ] 81% ETA 0:00:05      4.82MiB [========================================>       ] 86% ETA 0:00:044.83MiB [========================================>       ] 86% ETA 0:00:04  5.14MiB [==========================================>     ] 91% ETA 0:00:025.14MiB [==========================================>     ] 91% ETA 0:00:02  5.51MiB [==============================================> ] 98% ETA 0:00:005.52MiB [==============================================> ] 98% ETA 0:00:005.60MiB [==============================================>] 100%  /`````````````````````````````````````````````````````````````````````````````
  |Merger (sample: Modified) output message: 
  |----------------------------------------- 
  | 
  | java -Djava.library.path=/gpfs/projects/b1044/Software/shapemapper2-2.3/internals/thirdparty/miniconda/envs/shapemapper_make/opt/bbmap-37.78/jni/ -ea -Xmx1000m -Xmx1000m -cp /gpfs/projects/b1044/Software/shapemapper2-2.3/internals/thirdparty/miniconda/envs/shapemapper_make/opt/bbmap-37.78/current/ jgi.BBMerge vstrict=t in=stdin out=stdout outu=stdout interleaved=t usejni=t t=4
  | Executing jgi.BBMerge [vstrict=t, in=stdin, out=stdout, outu=stdout, interleaved=t, usejni=t, t=4]
  | Version 37.78 [vstrict=t, in=stdin, out=stdout, outu=stdout, interleaved=t, usejni=t, t=4]
  | 
  | Revised arguments: [maxbad=4, margin=3, minqo=8, qualiters=2, ratiomode=t, flatmode=f, minentropy=52, minoverlap=12, minoverlap0=4, maxratio=0.05, ratiomargin=12, ratiooffset=0.5, ratiominoverlapreduction=4, efilter=2, pfilter=0.008, minsecondratio=0.16, minapproxoverlap=22, in=stdin, out=stdout, outu=stdout, interleaved=t, usejni=t, t=4]
  | 
  | Set INTERLEAVED to true
  | Set threads to 4
  | Writing mergable reads merged.
  | Unspecified format for output stdout; defaulting to fastq.
  | Unspecified format for output stdout; defaulting to fastq.
  | Started output threads.
  | Unspecified format for input stdin; defaulting to fastq.
  | Total time: 33.276 seconds.
  | 
  | Pairs:               	246038
  | Joined:              	40044   	16.276%
  | Ambiguous:           	205994   	83.724%
  | No Solution:         	0       	0.000%
  | Too Short:           	0       	0.000%
  | 
  | Avg Insert:          	106.0
  | Standard Deviation:  	0.6
  | Mode:                	106
  | 
  | Insert range:        	50 - 129
  | 90th percentile:     	106
  | 75th percentile:     	106
  | 50th percentile:     	106
  | 25th percentile:     	106
  | 10th percentile:     	106
  \_____________________________________________________________________________
  /`````````````````````````````````````````````````````````````````````````````
  |BowtieAligner (sample: Modified) output message: 
  |------------------------------------------------ 
  | 
  | 246038 reads; of these:
  |   205994 (83.72%) were paired; of these:
  |     190746 (92.60%) aligned concordantly 0 times
  |     15246 (7.40%) aligned concordantly exactly 1 time
  |     2 (0.00%) aligned concordantly >1 times
  |     ----
  |     190746 pairs aligned concordantly 0 times; of these:
  |       0 (0.00%) aligned discordantly 1 time
  |     ----
  |     190746 pairs aligned 0 times concordantly or discordantly; of these:
  |       381492 mates make up the pairs; of these:
  |         191746 (50.26%) aligned 0 times
  |         189739 (49.74%) aligned exactly 1 time
  |         7 (0.00%) aligned >1 times
  |   40044 (16.28%) were unpaired; of these:
  |     26 (0.06%) aligned 0 times
  |     40018 (99.94%) aligned exactly 1 time
  |     0 (0.00%) aligned >1 times
  | 57.58% overall alignment rate
  \_____________________________________________________________________________
  /`````````````````````````````````````````````````````````````````````````````
  |MutationCounter_Modified (RNA: 031-EKC-A8C-75c-b-1-p) (sample: Modified) output message: 
  |---------------------------------------------------------------------------------------- 
  | 
  | Read lengths
  | --------------------
  | bin_range	frequency
  | [0,49]	0.001767
  | [50,99]	0.998233
  | [100,149]	0.000000
  | [150,199]	0.000000
  | [200,249]	0.000000
  | [250,299]	0.000000
  | [300,349]	0.000000
  | [350,399]	0.000000
  | [400,449]	0.000000
  | [450,499]	0.000000
  | [500,549]	0.000000
  | [550,599]	0.000000
  | [600,649]	0.000000
  | [650,699]	0.000000
  | [700,749]	0.000000
  | [750,799]	0.000000
  | [800,849]	0.000000
  | [850,899]	0.000000
  | [900,949]	0.000000
  | [950,999]	0.000000
  | >=1000	0.000000
  | --------------------
  | 
  | Mutations per read
  | --------------------
  | bin_left	frequency
  | 0	0.815340
  | 1	0.173979
  | 2	0.010506
  | 3	0.000167
  | 4	0.000008
  | 5	0.000000
  | 6	0.000000
  | 7	0.000000
  | 8	0.000000
  | 9	0.000000
  | 10	0.000000
  | 11	0.000000
  | 12	0.000000
  | 13	0.000000
  | 14	0.000000
  | 15	0.000000
  | 16	0.000000
  | 17	0.000000
  | 18	0.000000
  | 19	0.000000
  | 20	0.000000
  | --------------------
  \_____________________________________________________________________________
  /`````````````````````````````````````````````````````````````````````````````
  |MutationCounterGA_Modified (RNA: 031-EKC-A8C-75c-b-1-p) (sample: Modified) output message: 
  |------------------------------------------------------------------------------------------ 
  | 
  | Read lengths
  | --------------------
  | bin_range	frequency
  | [0,49]	0.001767
  | [50,99]	0.998233
  | [100,149]	0.000000
  | [150,199]	0.000000
  | [200,249]	0.000000
  | [250,299]	0.000000
  | [300,349]	0.000000
  | [350,399]	0.000000
  | [400,449]	0.000000
  | [450,499]	0.000000
  | [500,549]	0.000000
  | [550,599]	0.000000
  | [600,649]	0.000000
  | [650,699]	0.000000
  | [700,749]	0.000000
  | [750,799]	0.000000
  | [800,849]	0.000000
  | [850,899]	0.000000
  | [900,949]	0.000000
  | [950,999]	0.000000
  | >=1000	0.000000
  | --------------------
  | 
  | Mutations per read
  | --------------------
  | bin_left	frequency
  | 0	0.988241
  | 1	0.011726
  | 2	0.000029
  | 3	0.000004
  | 4	0.000000
  | 5	0.000000
  | 6	0.000000
  | 7	0.000000
  | 8	0.000000
  | 9	0.000000
  | 10	0.000000
  | 11	0.000000
  | 12	0.000000
  | 13	0.000000
  | 14	0.000000
  | 15	0.000000
  | 16	0.000000
  | 17	0.000000
  | 18	0.000000
  | 19	0.000000
  | 20	0.000000
  | --------------------
  \_____________________________________________________________________________
. . . done at 2025-10-14 17:52:01
Running CalcProfile at 2025-10-14 17:52:01 . . .
. . . done at 2025-10-14 17:52:01
Running NormProfile at 2025-10-14 17:52:01 . . .
/```````````````````````````````````````````````````````````````````````````````
|NormProfile (RNA: 031-EKC-A8C-75c-b-1-p) output message: 
|-------------------------------------------------------- 
| 
| Signal for U = 0.002 is below acceptable level. All U nts ignored
| Signal for G = 0.001 is below acceptable level. All G nts ignored
| calculated normalization factor: {'A': 0.013808, 'C': 0.0288, 'U': nan, 'G': nan}
\_______________________________________________________________________________
. . . done at 2025-10-14 17:52:01
Running CalcProfile at 2025-10-14 17:52:01 . . .
. . . done at 2025-10-14 17:52:02
Running NormProfile at 2025-10-14 17:52:02 . . .
/```````````````````````````````````````````````````````````````````````````````
|NormProfile (RNA: 031-EKC-A8C-75c-b-1-p) output message: 
|-------------------------------------------------------- 
| 
| calculated normalization factor: {'A': nan, 'C': nan, 'U': nan, 'G': 0.00153175, 'GPUR': 0.001325, 'GPYR': 0.0020384615384615385}
| ignoring n7 quality check.
\_______________________________________________________________________________
. . . done at 2025-10-14 17:52:02
Running TabToShape at 2025-10-14 17:52:02 . . .
. . . done at 2025-10-14 17:52:02
Running RenderFigures at 2025-10-14 17:52:02 . . .
/```````````````````````````````````````````````````````````````````````````````
|RenderFigures (RNA: 031-EKC-A8C-75c-b-1-p) output message: 
|---------------------------------------------------------- 
| 
| 
| DMS mode quality control checks:
| --------------------------------
| 
| ***************
| *   Nt = A    *
| ***************
| 
| Read depth check:
| 75.0% (9/12) nucleotides meet the minimum read depth of 5000
| FAIL: Read depths are too low for accurate reactivity profile creation.
|       Check alignment stats to see the amount of target sequence present
|       in each sample. Better target enrichment or recovery and/or
|       additional sequencing could help solve this problem.
| 
| Normalized rate check:
| PASS: Finite normalized rates present.
| 
| 
| ***************
| *   Nt = C    *
| ***************
| 
| Read depth check:
| 100.0% (3/3) nucleotides meet the minimum read depth of 5000
| PASS
| 
| Normalized rate check:
| PASS: Finite normalized rates present.
| 
| 
| ***************
| *   Nt = U    *
| ***************
| 
| Read depth check:
| 100.0% (13/13) nucleotides meet the minimum read depth of 5000
| PASS
| 
| Normalized rate check:
| FAIL: No finite normalized rates present.
|       This is either due to the nucleotide failing to
|       pass the normalization factor cutoff of at least
|       0.002 or due to the nucleotide having less than
|       20 nucleotides with quality reactivity information.
|       Please refer to the NormProfile section of this log
|       file for clarification
| 
| 
| ***************
| *   Nt = G    *
| ***************
| 
| Read depth check:
| 83.3% (10/12) nucleotides meet the minimum read depth of 5000
| PASS
| 
| Normalized rate check:
| FAIL: No finite normalized rates present.
|       This is either due to the nucleotide failing to
|       pass the normalization factor cutoff of at least
|       0.002 or due to the nucleotide having less than
|       20 nucleotides with quality reactivity information.
|       Please refer to the NormProfile section of this log
|       file for clarification
| 
| 
| -----------------------------------------------------------------
| 
|       Nucleotide passes all quality control checks: 
|         A: False
|         C: True
|         U: False
|         G: False
| 
| 
|       G and/or U FAILURE, but other reactivities may be usable
|       Possible causes:
|        - improper pH control during DMS reaction
|        - use of a different RT enzyme than MarathonRT
|        - poor reverse transcription conditions, resulting
|          in low adduct adduct read-through or detection
|        - very highly structured or protein bound RNA
| 
\_______________________________________________________________________________
. . . done at 2025-10-14 17:52:07
Running RenderMappedDepths at 2025-10-14 17:52:07 . . .
/```````````````````````````````````````````````````````````````````````````````
|RenderMappedDepths (RNA: 031-EKC-A8C-75c-b-1-p) output message: 
|--------------------------------------------------------------- 
| 
| Approximate maximum read depth for reads mapping near each amplicon primer pair
| (See *_mapped_depths.pdf for plots)
| (See *_per-amplicon_abundance.txt for exact numbers)
| 
| Modified:
|   pair forward                       left    right   reverse                       left    right   depth  
|   ---- ----------------------------- ------- ------- ----------------------------- ------- ------- ------ 
|   1    GGTGTAAGGGTGAAGTGTA           0       18      CTTCACCTTCATTACCTTTA          60      79      245k   
| 
\_______________________________________________________________________________
. . . done at 2025-10-14 17:52:08
ShapeMapper run completed at 2025-10-14 17:52:08.
WARNING: This RNA has a possible poor quality reactivity profile: 031-EKC-A8C-75c-b-1-p
See quality control checks above for details.
Deleting temp files. Use --output-temp to retain temp files.
################################################################################
# 3 - Verify FASTQ inputs
################################################################################
-rw-r--r-- 1 ekc5108 b1044 5.9M Sep 17  2024 /projects/b1044/Sequencing/SHAPE-Seq/EKC/230617_M05164_0145_000000000-L4LWB/032-EKC-A8C-75c-b-2-p_S32_L001_R1_001.fastq.gz
-rw-r--r-- 1 ekc5108 b1044 7.2M Sep 17  2024 /projects/b1044/Sequencing/SHAPE-Seq/EKC/230617_M05164_0145_000000000-L4LWB/032-EKC-A8C-75c-b-2-p_S32_L001_R2_001.fastq.gz
################################################################################
# 4 - Verify created FASTA
################################################################################
>032-EKC-A8C-75c-b-2-p
ggtgtaagggtgaagtgtaAGGTTGACCTTTTGAATAGTGATTCAGGAGGTTAATGGAAGtaaaggtaatgaaggtgaag
################################################################################
# 5 - Create shapemapper
################################################################################
Command: /projects/b1044/Software/shapemapper2-2.3/shapemapper --name 032-EKC-A8C-75c-b-2-p --target artifacts/032-EKC-A8C-75c-b-2-p/target.fa --out artifacts/032-EKC-A8C-75c-b-2-p --modified --R1 /projects/b1044/Sequencing/SHAPE-Seq/EKC/230617_M05164_0145_000000000-L4LWB/032-EKC-A8C-75c-b-2-p_S32_L001_R1_001.fastq.gz --R2 /projects/b1044/Sequencing/SHAPE-Seq/EKC/230617_M05164_0145_000000000-L4LWB/032-EKC-A8C-75c-b-2-p_S32_L001_R2_001.fastq.gz --amplicon --dms --N7 --bypass_filters --per-read-histograms
################################################################################
# 6 - Run shapemapper
################################################################################

################################################################################

Started ShapeMapper v2.3.0 at 2025-10-14 17:52:09
Output will be logged to 032-EKC-A8C-75c-b-2-p_shapemapper_log.txt
Running from directory: /gpfs/projects/b1044/Computational_Output/EKC/EKC.01_SHAPE_standardization/EKC.01.065.refactoring_data_analysis/nerd/examples/all_mutcounts/mut_count/mut_count___cfg-cc5447b
args:  --name 032-EKC-A8C-75c-b-2-p --target artifacts/032-EKC-A8C-75c-b-2-p/target.fa --out artifacts/032-EKC-A8C-75c-b-2-p --modified --R1 /projects/b1044/Sequencing/SHAPE-Seq/EKC/230617_M05164_0145_000000000-L4LWB/032-EKC-A8C-75c-b-2-p_S3... --R2 /projects/b1044/Sequencing/SHAPE-Seq/EKC/230617_M05164_0145_000000000-L4LWB/032-EKC-A8C-75c-b-2-p_S3... --amplicon --dms --N7 --bypass_filters --per-read-histograms
--bypass_filters flag passed - ignoring low N7 reactivity and setting per-NT threshold to 1.
Using default DMS max-bg of 0.02
	You can manually override using the max-bg flag
Created pipeline at 2025-10-14 17:52:09
Running PrimerLocator at 2025-10-14 17:52:09 . . .
. . . done at 2025-10-14 17:52:09
Running FastaFormatChecker at 2025-10-14 17:52:09 . . .
. . . done at 2025-10-14 17:52:09
Running BowtieIndexBuilder at 2025-10-14 17:52:09 . . .
. . . done at 2025-10-14 17:52:10
Running process group 4 at 2025-10-14 17:52:10 . . .
  Including these components:
    ProgressMonitor . . . started at 2025-10-14 17:52:10
    QualityTrimmer1 . . . started at 2025-10-14 17:52:10
    QualityTrimmer2 . . . started at 2025-10-14 17:52:10
    Interleaver . . . started at 2025-10-14 17:52:10
    Merger . . . started at 2025-10-14 17:52:10
    Tab6Interleaver . . . started at 2025-10-14 17:52:10
    BowtieAligner . . . started at 2025-10-14 17:52:10
    MutationParser_Modified . . . started at 2025-10-14 17:52:10
    MutationParserGA_Modified . . . started at 2025-10-14 17:52:10
    MutationCounter_Modified . . . started at 2025-10-14 17:52:10
    MutationCounterGA_Modified . . . started at 2025-10-14 17:52:10
  812KiB [=====>                                          ] 13% ETA 0:00:06 884KiB [=====>                                          ] 14% ETA 0:00:11  1.14MiB [========>                                       ] 19% ETA 0:00:12      1.52MiB [===========>                                    ] 25% ETA 0:00:11      1.89MiB [==============>                                 ] 32% ETA 0:00:10      2.22MiB [================>                               ] 37% ETA 0:00:112.23MiB [=================>                              ] 38% ETA 0:00:11  2.60MiB [====================>                           ] 44% ETA 0:00:10      2.90MiB [======================>                         ] 49% ETA 0:00:09      3.20MiB [========================>                       ] 54% ETA 0:00:083.27MiB [=========================>                      ] 55% ETA 0:00:08  3.57MiB [===========================>                    ] 60% ETA 0:00:103.57MiB [============================>                   ] 61% ETA 0:00:10  3.82MiB [==============================>                 ] 65% ETA 0:00:09      4.15MiB [================================>               ] 70% ETA 0:00:084.18MiB [=================================>              ] 71% ETA 0:00:08  4.79MiB [=====================================>          ] 81% ETA 0:00:054.80MiB [======================================>         ] 82% ETA 0:00:05  5.11MiB [========================================>       ] 87% ETA 0:00:03      5.42MiB [===========================================>    ] 92% ETA 0:00:025.43MiB [===========================================>    ] 92% ETA 0:00:02  5.79MiB [==============================================> ] 98% ETA 0:00:00      5.79MiB [==============================================> ] 99% ETA 0:00:005.85MiB [==============================================>] 100%  /`````````````````````````````````````````````````````````````````````````````
  |Merger (sample: Modified) output message: 
  |----------------------------------------- 
  | 
  | java -Djava.library.path=/gpfs/projects/b1044/Software/shapemapper2-2.3/internals/thirdparty/miniconda/envs/shapemapper_make/opt/bbmap-37.78/jni/ -ea -Xmx1000m -Xmx1000m -cp /gpfs/projects/b1044/Software/shapemapper2-2.3/internals/thirdparty/miniconda/envs/shapemapper_make/opt/bbmap-37.78/current/ jgi.BBMerge vstrict=t in=stdin out=stdout outu=stdout interleaved=t usejni=t t=4
  | Executing jgi.BBMerge [vstrict=t, in=stdin, out=stdout, outu=stdout, interleaved=t, usejni=t, t=4]
  | Version 37.78 [vstrict=t, in=stdin, out=stdout, outu=stdout, interleaved=t, usejni=t, t=4]
  | 
  | Revised arguments: [maxbad=4, margin=3, minqo=8, qualiters=2, ratiomode=t, flatmode=f, minentropy=52, minoverlap=12, minoverlap0=4, maxratio=0.05, ratiomargin=12, ratiooffset=0.5, ratiominoverlapreduction=4, efilter=2, pfilter=0.008, minsecondratio=0.16, minapproxoverlap=22, in=stdin, out=stdout, outu=stdout, interleaved=t, usejni=t, t=4]
  | 
  | Set INTERLEAVED to true
  | Set threads to 4
  | Writing mergable reads merged.
  | Unspecified format for output stdout; defaulting to fastq.
  | Unspecified format for output stdout; defaulting to fastq.
  | Started output threads.
  | Unspecified format for input stdin; defaulting to fastq.
  | Total time: 30.008 seconds.
  | 
  | Pairs:               	243656
  | Joined:              	38416   	15.766%
  | Ambiguous:           	205240   	84.234%
  | No Solution:         	0       	0.000%
  | Too Short:           	0       	0.000%
  | 
  | Avg Insert:          	106.0
  | Standard Deviation:  	0.7
  | Mode:                	106
  | 
  | Insert range:        	50 - 137
  | 90th percentile:     	106
  | 75th percentile:     	106
  | 50th percentile:     	106
  | 25th percentile:     	106
  | 10th percentile:     	106
  \_____________________________________________________________________________
  /`````````````````````````````````````````````````````````````````````````````
  |BowtieAligner (sample: Modified) output message: 
  |------------------------------------------------ 
  | 
  | 243656 reads; of these:
  |   205240 (84.23%) were paired; of these:
  |     187734 (91.47%) aligned concordantly 0 times
  |     17502 (8.53%) aligned concordantly exactly 1 time
  |     4 (0.00%) aligned concordantly >1 times
  |     ----
  |     187734 pairs aligned concordantly 0 times; of these:
  |       0 (0.00%) aligned discordantly 1 time
  |     ----
  |     187734 pairs aligned 0 times concordantly or discordantly; of these:
  |       375468 mates make up the pairs; of these:
  |         189329 (50.42%) aligned 0 times
  |         186131 (49.57%) aligned exactly 1 time
  |         8 (0.00%) aligned >1 times
  |   38416 (15.77%) were unpaired; of these:
  |     40 (0.10%) aligned 0 times
  |     38376 (99.90%) aligned exactly 1 time
  |     0 (0.00%) aligned >1 times
  | 57.81% overall alignment rate
  \_____________________________________________________________________________
  /`````````````````````````````````````````````````````````````````````````````
  |MutationCounter_Modified (RNA: 032-EKC-A8C-75c-b-2-p) (sample: Modified) output message: 
  |---------------------------------------------------------------------------------------- 
  | 
  | Read lengths
  | --------------------
  | bin_range	frequency
  | [0,49]	0.002020
  | [50,99]	0.997980
  | [100,149]	0.000000
  | [150,199]	0.000000
  | [200,249]	0.000000
  | [250,299]	0.000000
  | [300,349]	0.000000
  | [350,399]	0.000000
  | [400,449]	0.000000
  | [450,499]	0.000000
  | [500,549]	0.000000
  | [550,599]	0.000000
  | [600,649]	0.000000
  | [650,699]	0.000000
  | [700,749]	0.000000
  | [750,799]	0.000000
  | [800,849]	0.000000
  | [850,899]	0.000000
  | [900,949]	0.000000
  | [950,999]	0.000000
  | >=1000	0.000000
  | --------------------
  | 
  | Mutations per read
  | --------------------
  | bin_left	frequency
  | 0	0.747989
  | 1	0.231926
  | 2	0.019585
  | 3	0.000500
  | 4	0.000000
  | 5	0.000000
  | 6	0.000000
  | 7	0.000000
  | 8	0.000000
  | 9	0.000000
  | 10	0.000000
  | 11	0.000000
  | 12	0.000000
  | 13	0.000000
  | 14	0.000000
  | 15	0.000000
  | 16	0.000000
  | 17	0.000000
  | 18	0.000000
  | 19	0.000000
  | 20	0.000000
  | --------------------
  \_____________________________________________________________________________
  /`````````````````````````````````````````````````````````````````````````````
  |MutationCounterGA_Modified (RNA: 032-EKC-A8C-75c-b-2-p) (sample: Modified) output message: 
  |------------------------------------------------------------------------------------------ 
  | 
  | Read lengths
  | --------------------
  | bin_range	frequency
  | [0,49]	0.002020
  | [50,99]	0.997980
  | [100,149]	0.000000
  | [150,199]	0.000000
  | [200,249]	0.000000
  | [250,299]	0.000000
  | [300,349]	0.000000
  | [350,399]	0.000000
  | [400,449]	0.000000
  | [450,499]	0.000000
  | [500,549]	0.000000
  | [550,599]	0.000000
  | [600,649]	0.000000
  | [650,699]	0.000000
  | [700,749]	0.000000
  | [750,799]	0.000000
  | [800,849]	0.000000
  | [850,899]	0.000000
  | [900,949]	0.000000
  | [950,999]	0.000000
  | >=1000	0.000000
  | --------------------
  | 
  | Mutations per read
  | --------------------
  | bin_left	frequency
  | 0	0.984415
  | 1	0.015519
  | 2	0.000066
  | 3	0.000000
  | 4	0.000000
  | 5	0.000000
  | 6	0.000000
  | 7	0.000000
  | 8	0.000000
  | 9	0.000000
  | 10	0.000000
  | 11	0.000000
  | 12	0.000000
  | 13	0.000000
  | 14	0.000000
  | 15	0.000000
  | 16	0.000000
  | 17	0.000000
  | 18	0.000000
  | 19	0.000000
  | 20	0.000000
  | --------------------
  \_____________________________________________________________________________
. . . done at 2025-10-14 17:52:40
Running CalcProfile at 2025-10-14 17:52:40 . . .
. . . done at 2025-10-14 17:52:40
Running NormProfile at 2025-10-14 17:52:40 . . .
/```````````````````````````````````````````````````````````````````````````````
|NormProfile (RNA: 032-EKC-A8C-75c-b-2-p) output message: 
|-------------------------------------------------------- 
| 
| Signal for U = 0.002 is below acceptable level. All U nts ignored
| Signal for G = 0.001 is below acceptable level. All G nts ignored
| calculated normalization factor: {'A': 0.019519, 'C': 0.0430865, 'U': nan, 'G': nan}
\_______________________________________________________________________________
. . . done at 2025-10-14 17:52:41
Running CalcProfile at 2025-10-14 17:52:41 . . .
. . . done at 2025-10-14 17:52:41
Running NormProfile at 2025-10-14 17:52:41 . . .
/```````````````````````````````````````````````````````````````````````````````
|NormProfile (RNA: 032-EKC-A8C-75c-b-2-p) output message: 
|-------------------------------------------------------- 
| 
| calculated normalization factor: {'A': nan, 'C': nan, 'U': nan, 'G': 0.002085, 'GPUR': 0.0017135, 'GPYR': 0.002636153846153846}
| ignoring n7 quality check.
\_______________________________________________________________________________
. . . done at 2025-10-14 17:52:41
Running TabToShape at 2025-10-14 17:52:41 . . .
. . . done at 2025-10-14 17:52:41
Running RenderFigures at 2025-10-14 17:52:41 . . .
/```````````````````````````````````````````````````````````````````````````````
|RenderFigures (RNA: 032-EKC-A8C-75c-b-2-p) output message: 
|---------------------------------------------------------- 
| 
| 
| DMS mode quality control checks:
| --------------------------------
| 
| ***************
| *   Nt = A    *
| ***************
| 
| Read depth check:
| 75.0% (9/12) nucleotides meet the minimum read depth of 5000
| FAIL: Read depths are too low for accurate reactivity profile creation.
|       Check alignment stats to see the amount of target sequence present
|       in each sample. Better target enrichment or recovery and/or
|       additional sequencing could help solve this problem.
| 
| Normalized rate check:
| PASS: Finite normalized rates present.
| 
| 
| ***************
| *   Nt = C    *
| ***************
| 
| Read depth check:
| 100.0% (3/3) nucleotides meet the minimum read depth of 5000
| PASS
| 
| Normalized rate check:
| PASS: Finite normalized rates present.
| 
| 
| ***************
| *   Nt = U    *
| ***************
| 
| Read depth check:
| 100.0% (13/13) nucleotides meet the minimum read depth of 5000
| PASS
| 
| Normalized rate check:
| FAIL: No finite normalized rates present.
|       This is either due to the nucleotide failing to
|       pass the normalization factor cutoff of at least
|       0.002 or due to the nucleotide having less than
|       20 nucleotides with quality reactivity information.
|       Please refer to the NormProfile section of this log
|       file for clarification
| 
| 
| ***************
| *   Nt = G    *
| ***************
| 
| Read depth check:
| 83.3% (10/12) nucleotides meet the minimum read depth of 5000
| PASS
| 
| Normalized rate check:
| FAIL: No finite normalized rates present.
|       This is either due to the nucleotide failing to
|       pass the normalization factor cutoff of at least
|       0.002 or due to the nucleotide having less than
|       20 nucleotides with quality reactivity information.
|       Please refer to the NormProfile section of this log
|       file for clarification
| 
| 
| -----------------------------------------------------------------
| 
|       Nucleotide passes all quality control checks: 
|         A: False
|         C: True
|         U: False
|         G: False
| 
| 
|       G and/or U FAILURE, but other reactivities may be usable
|       Possible causes:
|        - improper pH control during DMS reaction
|        - use of a different RT enzyme than MarathonRT
|        - poor reverse transcription conditions, resulting
|          in low adduct adduct read-through or detection
|        - very highly structured or protein bound RNA
| 
\_______________________________________________________________________________
. . . done at 2025-10-14 17:52:45
Running RenderMappedDepths at 2025-10-14 17:52:45 . . .
/```````````````````````````````````````````````````````````````````````````````
|RenderMappedDepths (RNA: 032-EKC-A8C-75c-b-2-p) output message: 
|--------------------------------------------------------------- 
| 
| Approximate maximum read depth for reads mapping near each amplicon primer pair
| (See *_mapped_depths.pdf for plots)
| (See *_per-amplicon_abundance.txt for exact numbers)
| 
| Modified:
|   pair forward                       left    right   reverse                       left    right   depth  
|   ---- ----------------------------- ------- ------- ----------------------------- ------- ------- ------ 
|   1    GGTGTAAGGGTGAAGTGTA           0       18      CTTCACCTTCATTACCTTTA          60      79      242k   
| 
\_______________________________________________________________________________
. . . done at 2025-10-14 17:52:46
ShapeMapper run completed at 2025-10-14 17:52:46.
WARNING: This RNA has a possible poor quality reactivity profile: 032-EKC-A8C-75c-b-2-p
See quality control checks above for details.
Deleting temp files. Use --output-temp to retain temp files.
################################################################################
# 3 - Verify FASTQ inputs
################################################################################
-rw-r--r-- 1 ekc5108 b1044 4.9M Sep 17  2024 /projects/b1044/Sequencing/SHAPE-Seq/EKC/230617_M05164_0145_000000000-L4LWB/033-EKC-A8C-75c-b-3-p_S33_L001_R1_001.fastq.gz
-rw-r--r-- 1 ekc5108 b1044 6.1M Sep 17  2024 /projects/b1044/Sequencing/SHAPE-Seq/EKC/230617_M05164_0145_000000000-L4LWB/033-EKC-A8C-75c-b-3-p_S33_L001_R2_001.fastq.gz
################################################################################
# 4 - Verify created FASTA
################################################################################
>033-EKC-A8C-75c-b-3-p
ggtgtaagggtgaagtgtaAGGTTGACCTTTTGAATAGTGATTCAGGAGGTTAATGGAAGtaaaggtaatgaaggtgaag
################################################################################
# 5 - Create shapemapper
################################################################################
Command: /projects/b1044/Software/shapemapper2-2.3/shapemapper --name 033-EKC-A8C-75c-b-3-p --target artifacts/033-EKC-A8C-75c-b-3-p/target.fa --out artifacts/033-EKC-A8C-75c-b-3-p --modified --R1 /projects/b1044/Sequencing/SHAPE-Seq/EKC/230617_M05164_0145_000000000-L4LWB/033-EKC-A8C-75c-b-3-p_S33_L001_R1_001.fastq.gz --R2 /projects/b1044/Sequencing/SHAPE-Seq/EKC/230617_M05164_0145_000000000-L4LWB/033-EKC-A8C-75c-b-3-p_S33_L001_R2_001.fastq.gz --amplicon --dms --N7 --bypass_filters --per-read-histograms
################################################################################
# 6 - Run shapemapper
################################################################################

################################################################################

Started ShapeMapper v2.3.0 at 2025-10-14 17:52:47
Output will be logged to 033-EKC-A8C-75c-b-3-p_shapemapper_log.txt
Running from directory: /gpfs/projects/b1044/Computational_Output/EKC/EKC.01_SHAPE_standardization/EKC.01.065.refactoring_data_analysis/nerd/examples/all_mutcounts/mut_count/mut_count___cfg-cc5447b
args:  --name 033-EKC-A8C-75c-b-3-p --target artifacts/033-EKC-A8C-75c-b-3-p/target.fa --out artifacts/033-EKC-A8C-75c-b-3-p --modified --R1 /projects/b1044/Sequencing/SHAPE-Seq/EKC/230617_M05164_0145_000000000-L4LWB/033-EKC-A8C-75c-b-3-p_S3... --R2 /projects/b1044/Sequencing/SHAPE-Seq/EKC/230617_M05164_0145_000000000-L4LWB/033-EKC-A8C-75c-b-3-p_S3... --amplicon --dms --N7 --bypass_filters --per-read-histograms
--bypass_filters flag passed - ignoring low N7 reactivity and setting per-NT threshold to 1.
Using default DMS max-bg of 0.02
	You can manually override using the max-bg flag
Created pipeline at 2025-10-14 17:52:47
Running PrimerLocator at 2025-10-14 17:52:47 . . .
. . . done at 2025-10-14 17:52:47
Running FastaFormatChecker at 2025-10-14 17:52:47 . . .
. . . done at 2025-10-14 17:52:47
Running BowtieIndexBuilder at 2025-10-14 17:52:47 . . .
. . . done at 2025-10-14 17:52:48
Running process group 4 at 2025-10-14 17:52:48 . . .
  Including these components:
    ProgressMonitor . . . started at 2025-10-14 17:52:48
    QualityTrimmer1 . . . started at 2025-10-14 17:52:48
    QualityTrimmer2 . . . started at 2025-10-14 17:52:48
    Interleaver . . . started at 2025-10-14 17:52:48
    Merger . . . started at 2025-10-14 17:52:48
    Tab6Interleaver . . . started at 2025-10-14 17:52:48
    BowtieAligner . . . started at 2025-10-14 17:52:48
    MutationParser_Modified . . . started at 2025-10-14 17:52:48
    MutationParserGA_Modified . . . started at 2025-10-14 17:52:48
    MutationCounter_Modified . . . started at 2025-10-14 17:52:48
    MutationCounterGA_Modified . . . started at 2025-10-14 17:52:48
  860KiB [=======>                                        ] 17% ETA 0:00:041.01MiB [========>                                       ] 20% ETA 0:00:07  1.20MiB [==========>                                     ] 24% ETA 0:00:09      1.60MiB [==============>                                 ] 32% ETA 0:00:08      1.96MiB [=================>                              ] 39% ETA 0:00:07      2.35MiB [=====================>                          ] 47% ETA 0:00:062.50MiB [=======================>                        ] 50% ETA 0:00:06  2.62MiB [========================>                       ] 53% ETA 0:00:06      3.02MiB [============================>                   ] 61% ETA 0:00:083.03MiB [============================>                   ] 61% ETA 0:00:08  3.30MiB [===============================>                ] 67% ETA 0:00:06      3.65MiB [==================================>             ] 74% ETA 0:00:053.66MiB [==================================>             ] 74% ETA 0:00:05  4.00MiB [=====================================>          ] 81% ETA 0:00:03      4.33MiB [=========================================>      ] 88% ETA 0:00:02      4.68MiB [============================================>   ] 95% ETA 0:00:014.74MiB [=============================================>  ] 96% ETA 0:00:004.90MiB [==============================================>] 100%  /`````````````````````````````````````````````````````````````````````````````
  |Merger (sample: Modified) output message: 
  |----------------------------------------- 
  | 
  | java -Djava.library.path=/gpfs/projects/b1044/Software/shapemapper2-2.3/internals/thirdparty/miniconda/envs/shapemapper_make/opt/bbmap-37.78/jni/ -ea -Xmx1000m -Xmx1000m -cp /gpfs/projects/b1044/Software/shapemapper2-2.3/internals/thirdparty/miniconda/envs/shapemapper_make/opt/bbmap-37.78/current/ jgi.BBMerge vstrict=t in=stdin out=stdout outu=stdout interleaved=t usejni=t t=4
  | Executing jgi.BBMerge [vstrict=t, in=stdin, out=stdout, outu=stdout, interleaved=t, usejni=t, t=4]
  | Version 37.78 [vstrict=t, in=stdin, out=stdout, outu=stdout, interleaved=t, usejni=t, t=4]
  | 
  | Revised arguments: [maxbad=4, margin=3, minqo=8, qualiters=2, ratiomode=t, flatmode=f, minentropy=52, minoverlap=12, minoverlap0=4, maxratio=0.05, ratiomargin=12, ratiooffset=0.5, ratiominoverlapreduction=4, efilter=2, pfilter=0.008, minsecondratio=0.16, minapproxoverlap=22, in=stdin, out=stdout, outu=stdout, interleaved=t, usejni=t, t=4]
  | 
  | Set INTERLEAVED to true
  | Set threads to 4
  | Writing mergable reads merged.
  | Unspecified format for output stdout; defaulting to fastq.
  | Unspecified format for output stdout; defaulting to fastq.
  | Started output threads.
  | Unspecified format for input stdin; defaulting to fastq.
  | Total time: 23.386 seconds.
  | 
  | Pairs:               	193482
  | Joined:              	30771   	15.904%
  | Ambiguous:           	162711   	84.096%
  | No Solution:         	0       	0.000%
  | Too Short:           	0       	0.000%
  | 
  | Avg Insert:          	106.0
  | Standard Deviation:  	1.0
  | Mode:                	106
  | 
  | Insert range:        	50 - 120
  | 90th percentile:     	106
  | 75th percentile:     	106
  | 50th percentile:     	106
  | 25th percentile:     	106
  | 10th percentile:     	106
  \_____________________________________________________________________________
  /`````````````````````````````````````````````````````````````````````````````
  |BowtieAligner (sample: Modified) output message: 
  |------------------------------------------------ 
  | 
  | 193482 reads; of these:
  |   162711 (84.10%) were paired; of these:
  |     149536 (91.90%) aligned concordantly 0 times
  |     13174 (8.10%) aligned concordantly exactly 1 time
  |     1 (0.00%) aligned concordantly >1 times
  |     ----
  |     149536 pairs aligned concordantly 0 times; of these:
  |       1 (0.00%) aligned discordantly 1 time
  |     ----
  |     149535 pairs aligned 0 times concordantly or discordantly; of these:
  |       299070 mates make up the pairs; of these:
  |         151798 (50.76%) aligned 0 times
  |         147265 (49.24%) aligned exactly 1 time
  |         7 (0.00%) aligned >1 times
  |   30771 (15.90%) were unpaired; of these:
  |     99 (0.32%) aligned 0 times
  |     30672 (99.68%) aligned exactly 1 time
  |     0 (0.00%) aligned >1 times
  | 57.36% overall alignment rate
  \_____________________________________________________________________________
  /`````````````````````````````````````````````````````````````````````````````
  |MutationCounter_Modified (RNA: 033-EKC-A8C-75c-b-3-p) (sample: Modified) output message: 
  |---------------------------------------------------------------------------------------- 
  | 
  | Read lengths
  | --------------------
  | bin_range	frequency
  | [0,49]	0.002229
  | [50,99]	0.997771
  | [100,149]	0.000000
  | [150,199]	0.000000
  | [200,249]	0.000000
  | [250,299]	0.000000
  | [300,349]	0.000000
  | [350,399]	0.000000
  | [400,449]	0.000000
  | [450,499]	0.000000
  | [500,549]	0.000000
  | [550,599]	0.000000
  | [600,649]	0.000000
  | [650,699]	0.000000
  | [700,749]	0.000000
  | [750,799]	0.000000
  | [800,849]	0.000000
  | [850,899]	0.000000
  | [900,949]	0.000000
  | [950,999]	0.000000
  | >=1000	0.000000
  | --------------------
  | 
  | Mutations per read
  | --------------------
  | bin_left	frequency
  | 0	0.677921
  | 1	0.287258
  | 2	0.033560
  | 3	0.001224
  | 4	0.000037
  | 5	0.000000
  | 6	0.000000
  | 7	0.000000
  | 8	0.000000
  | 9	0.000000
  | 10	0.000000
  | 11	0.000000
  | 12	0.000000
  | 13	0.000000
  | 14	0.000000
  | 15	0.000000
  | 16	0.000000
  | 17	0.000000
  | 18	0.000000
  | 19	0.000000
  | 20	0.000000
  | --------------------
  \_____________________________________________________________________________
  /`````````````````````````````````````````````````````````````````````````````
  |MutationCounterGA_Modified (RNA: 033-EKC-A8C-75c-b-3-p) (sample: Modified) output message: 
  |------------------------------------------------------------------------------------------ 
  | 
  | Read lengths
  | --------------------
  | bin_range	frequency
  | [0,49]	0.002229
  | [50,99]	0.997771
  | [100,149]	0.000000
  | [150,199]	0.000000
  | [200,249]	0.000000
  | [250,299]	0.000000
  | [300,349]	0.000000
  | [350,399]	0.000000
  | [400,449]	0.000000
  | [450,499]	0.000000
  | [500,549]	0.000000
  | [550,599]	0.000000
  | [600,649]	0.000000
  | [650,699]	0.000000
  | [700,749]	0.000000
  | [750,799]	0.000000
  | [800,849]	0.000000
  | [850,899]	0.000000
  | [900,949]	0.000000
  | [950,999]	0.000000
  | >=1000	0.000000
  | --------------------
  | 
  | Mutations per read
  | --------------------
  | bin_left	frequency
  | 0	0.980311
  | 1	0.019564
  | 2	0.000115
  | 3	0.000000
  | 4	0.000010
  | 5	0.000000
  | 6	0.000000
  | 7	0.000000
  | 8	0.000000
  | 9	0.000000
  | 10	0.000000
  | 11	0.000000
  | 12	0.000000
  | 13	0.000000
  | 14	0.000000
  | 15	0.000000
  | 16	0.000000
  | 17	0.000000
  | 18	0.000000
  | 19	0.000000
  | 20	0.000000
  | --------------------
  \_____________________________________________________________________________
. . . done at 2025-10-14 17:53:11
Running CalcProfile at 2025-10-14 17:53:11 . . .
. . . done at 2025-10-14 17:53:12
Running NormProfile at 2025-10-14 17:53:12 . . .
/```````````````````````````````````````````````````````````````````````````````
|NormProfile (RNA: 033-EKC-A8C-75c-b-3-p) output message: 
|-------------------------------------------------------- 
| 
| Signal for U = 0.002 is below acceptable level. All U nts ignored
| Signal for G = 0.001 is below acceptable level. All G nts ignored
| calculated normalization factor: {'A': 0.026954, 'C': 0.0524025, 'U': nan, 'G': nan}
\_______________________________________________________________________________
. . . done at 2025-10-14 17:53:12
Running CalcProfile at 2025-10-14 17:53:12 . . .
. . . done at 2025-10-14 17:53:12
Running NormProfile at 2025-10-14 17:53:12 . . .
/```````````````````````````````````````````````````````````````````````````````
|NormProfile (RNA: 033-EKC-A8C-75c-b-3-p) output message: 
|-------------------------------------------------------- 
| 
| calculated normalization factor: {'A': nan, 'C': nan, 'U': nan, 'G': 0.00265025, 'GPUR': 0.00234075, 'GPYR': 0.003601153846153846}
| ignoring n7 quality check.
\_______________________________________________________________________________
. . . done at 2025-10-14 17:53:12
Running TabToShape at 2025-10-14 17:53:12 . . .
. . . done at 2025-10-14 17:53:13
Running RenderFigures at 2025-10-14 17:53:13 . . .
/```````````````````````````````````````````````````````````````````````````````
|RenderFigures (RNA: 033-EKC-A8C-75c-b-3-p) output message: 
|---------------------------------------------------------- 
| 
| 
| DMS mode quality control checks:
| --------------------------------
| 
| ***************
| *   Nt = A    *
| ***************
| 
| Read depth check:
| 75.0% (9/12) nucleotides meet the minimum read depth of 5000
| FAIL: Read depths are too low for accurate reactivity profile creation.
|       Check alignment stats to see the amount of target sequence present
|       in each sample. Better target enrichment or recovery and/or
|       additional sequencing could help solve this problem.
| 
| Normalized rate check:
| PASS: Finite normalized rates present.
| 
| 
| ***************
| *   Nt = C    *
| ***************
| 
| Read depth check:
| 100.0% (3/3) nucleotides meet the minimum read depth of 5000
| PASS
| 
| Normalized rate check:
| PASS: Finite normalized rates present.
| 
| 
| ***************
| *   Nt = U    *
| ***************
| 
| Read depth check:
| 100.0% (13/13) nucleotides meet the minimum read depth of 5000
| PASS
| 
| Normalized rate check:
| FAIL: No finite normalized rates present.
|       This is either due to the nucleotide failing to
|       pass the normalization factor cutoff of at least
|       0.002 or due to the nucleotide having less than
|       20 nucleotides with quality reactivity information.
|       Please refer to the NormProfile section of this log
|       file for clarification
| 
| 
| ***************
| *   Nt = G    *
| ***************
| 
| Read depth check:
| 83.3% (10/12) nucleotides meet the minimum read depth of 5000
| PASS
| 
| Normalized rate check:
| FAIL: No finite normalized rates present.
|       This is either due to the nucleotide failing to
|       pass the normalization factor cutoff of at least
|       0.002 or due to the nucleotide having less than
|       20 nucleotides with quality reactivity information.
|       Please refer to the NormProfile section of this log
|       file for clarification
| 
| 
| -----------------------------------------------------------------
| 
|       Nucleotide passes all quality control checks: 
|         A: False
|         C: True
|         U: False
|         G: False
| 
| 
|       G and/or U FAILURE, but other reactivities may be usable
|       Possible causes:
|        - improper pH control during DMS reaction
|        - use of a different RT enzyme than MarathonRT
|        - poor reverse transcription conditions, resulting
|          in low adduct adduct read-through or detection
|        - very highly structured or protein bound RNA
| 
\_______________________________________________________________________________
. . . done at 2025-10-14 17:53:16
Running RenderMappedDepths at 2025-10-14 17:53:16 . . .
/```````````````````````````````````````````````````````````````````````````````
|RenderMappedDepths (RNA: 033-EKC-A8C-75c-b-3-p) output message: 
|--------------------------------------------------------------- 
| 
| Approximate maximum read depth for reads mapping near each amplicon primer pair
| (See *_mapped_depths.pdf for plots)
| (See *_per-amplicon_abundance.txt for exact numbers)
| 
| Modified:
|   pair forward                       left    right   reverse                       left    right   depth  
|   ---- ----------------------------- ------- ------- ----------------------------- ------- ------- ------ 
|   1    GGTGTAAGGGTGAAGTGTA           0       18      CTTCACCTTCATTACCTTTA          60      79      191k   
| 
\_______________________________________________________________________________
. . . done at 2025-10-14 17:53:17
ShapeMapper run completed at 2025-10-14 17:53:17.
WARNING: This RNA has a possible poor quality reactivity profile: 033-EKC-A8C-75c-b-3-p
See quality control checks above for details.
Deleting temp files. Use --output-temp to retain temp files.
################################################################################
# 3 - Verify FASTQ inputs
################################################################################
-rw-r--r-- 1 ekc5108 b1044 5.2M Sep 17  2024 /projects/b1044/Sequencing/SHAPE-Seq/EKC/230617_M05164_0145_000000000-L4LWB/034-EKC-A8C-75c-b-4-p_S34_L001_R1_001.fastq.gz
-rw-r--r-- 1 ekc5108 b1044 6.5M Sep 17  2024 /projects/b1044/Sequencing/SHAPE-Seq/EKC/230617_M05164_0145_000000000-L4LWB/034-EKC-A8C-75c-b-4-p_S34_L001_R2_001.fastq.gz
################################################################################
# 4 - Verify created FASTA
################################################################################
>034-EKC-A8C-75c-b-4-p
ggtgtaagggtgaagtgtaAGGTTGACCTTTTGAATAGTGATTCAGGAGGTTAATGGAAGtaaaggtaatgaaggtgaag
################################################################################
# 5 - Create shapemapper
################################################################################
Command: /projects/b1044/Software/shapemapper2-2.3/shapemapper --name 034-EKC-A8C-75c-b-4-p --target artifacts/034-EKC-A8C-75c-b-4-p/target.fa --out artifacts/034-EKC-A8C-75c-b-4-p --modified --R1 /projects/b1044/Sequencing/SHAPE-Seq/EKC/230617_M05164_0145_000000000-L4LWB/034-EKC-A8C-75c-b-4-p_S34_L001_R1_001.fastq.gz --R2 /projects/b1044/Sequencing/SHAPE-Seq/EKC/230617_M05164_0145_000000000-L4LWB/034-EKC-A8C-75c-b-4-p_S34_L001_R2_001.fastq.gz --amplicon --dms --N7 --bypass_filters --per-read-histograms
################################################################################
# 6 - Run shapemapper
################################################################################

################################################################################

Started ShapeMapper v2.3.0 at 2025-10-14 17:53:18
Output will be logged to 034-EKC-A8C-75c-b-4-p_shapemapper_log.txt
Running from directory: /gpfs/projects/b1044/Computational_Output/EKC/EKC.01_SHAPE_standardization/EKC.01.065.refactoring_data_analysis/nerd/examples/all_mutcounts/mut_count/mut_count___cfg-cc5447b
args:  --name 034-EKC-A8C-75c-b-4-p --target artifacts/034-EKC-A8C-75c-b-4-p/target.fa --out artifacts/034-EKC-A8C-75c-b-4-p --modified --R1 /projects/b1044/Sequencing/SHAPE-Seq/EKC/230617_M05164_0145_000000000-L4LWB/034-EKC-A8C-75c-b-4-p_S3... --R2 /projects/b1044/Sequencing/SHAPE-Seq/EKC/230617_M05164_0145_000000000-L4LWB/034-EKC-A8C-75c-b-4-p_S3... --amplicon --dms --N7 --bypass_filters --per-read-histograms
--bypass_filters flag passed - ignoring low N7 reactivity and setting per-NT threshold to 1.
Using default DMS max-bg of 0.02
	You can manually override using the max-bg flag
Created pipeline at 2025-10-14 17:53:18
Running PrimerLocator at 2025-10-14 17:53:18 . . .
. . . done at 2025-10-14 17:53:18
Running FastaFormatChecker at 2025-10-14 17:53:18 . . .
. . . done at 2025-10-14 17:53:18
Running BowtieIndexBuilder at 2025-10-14 17:53:18 . . .
. . . done at 2025-10-14 17:53:18
Running process group 4 at 2025-10-14 17:53:18 . . .
  Including these components:
    ProgressMonitor . . . started at 2025-10-14 17:53:18
    QualityTrimmer1 . . . started at 2025-10-14 17:53:18
    QualityTrimmer2 . . . started at 2025-10-14 17:53:18
    Interleaver . . . started at 2025-10-14 17:53:18
    Merger . . . started at 2025-10-14 17:53:18
    Tab6Interleaver . . . started at 2025-10-14 17:53:18
    BowtieAligner . . . started at 2025-10-14 17:53:18
    MutationParser_Modified . . . started at 2025-10-14 17:53:18
    MutationParserGA_Modified . . . started at 2025-10-14 17:53:18
    MutationCounter_Modified . . . started at 2025-10-14 17:53:18
    MutationCounterGA_Modified . . . started at 2025-10-14 17:53:18
  876KiB [======>                                         ] 16% ETA 0:00:05       1.07MiB [========>                                       ] 20% ETA 0:00:07      1.21MiB [==========>                                     ] 23% ETA 0:00:09      1.61MiB [=============>                                  ] 31% ETA 0:00:08      2.00MiB [=================>                              ] 38% ETA 0:00:07      2.36MiB [====================>                           ] 45% ETA 0:00:07      2.69MiB [=======================>                        ] 51% ETA 0:00:062.82MiB [========================>                       ] 54% ETA 0:00:06  3.09MiB [===========================>                    ] 59% ETA 0:00:083.10MiB [===========================>                    ] 59% ETA 0:00:08  3.38MiB [=============================>                  ] 64% ETA 0:00:073.39MiB [==============================>                 ] 65% ETA 0:00:07  3.76MiB [=================================>              ] 72% ETA 0:00:063.77MiB [=================================>              ] 72% ETA 0:00:06  4.04MiB [===================================>            ] 77% ETA 0:00:04      4.41MiB [=======================================>        ] 84% ETA 0:00:03      4.73MiB [==========================================>     ] 90% ETA 0:00:014.74MiB [==========================================>     ] 91% ETA 0:00:01  5.11MiB [==============================================> ] 98% ETA 0:00:005.12MiB [==============================================> ] 98% ETA 0:00:00  5.20MiB [==============================================>] 100%                  /`````````````````````````````````````````````````````````````````````````````
  |Merger (sample: Modified) output message: 
  |----------------------------------------- 
  | 
  | java -Djava.library.path=/gpfs/projects/b1044/Software/shapemapper2-2.3/internals/thirdparty/miniconda/envs/shapemapper_make/opt/bbmap-37.78/jni/ -ea -Xmx1000m -Xmx1000m -cp /gpfs/projects/b1044/Software/shapemapper2-2.3/internals/thirdparty/miniconda/envs/shapemapper_make/opt/bbmap-37.78/current/ jgi.BBMerge vstrict=t in=stdin out=stdout outu=stdout interleaved=t usejni=t t=4
  | Executing jgi.BBMerge [vstrict=t, in=stdin, out=stdout, outu=stdout, interleaved=t, usejni=t, t=4]
  | Version 37.78 [vstrict=t, in=stdin, out=stdout, outu=stdout, interleaved=t, usejni=t, t=4]
  | 
  | Revised arguments: [maxbad=4, margin=3, minqo=8, qualiters=2, ratiomode=t, flatmode=f, minentropy=52, minoverlap=12, minoverlap0=4, maxratio=0.05, ratiomargin=12, ratiooffset=0.5, ratiominoverlapreduction=4, efilter=2, pfilter=0.008, minsecondratio=0.16, minapproxoverlap=22, in=stdin, out=stdout, outu=stdout, interleaved=t, usejni=t, t=4]
  | 
  | Set INTERLEAVED to true
  | Set threads to 4
  | Writing mergable reads merged.
  | Unspecified format for output stdout; defaulting to fastq.
  | Unspecified format for output stdout; defaulting to fastq.
  | Started output threads.
  | Unspecified format for input stdin; defaulting to fastq.
  | Total time: 24.224 seconds.
  | 
  | Pairs:               	202300
  | Joined:              	32086   	15.861%
  | Ambiguous:           	170214   	84.139%
  | No Solution:         	0       	0.000%
  | Too Short:           	0       	0.000%
  | 
  | Avg Insert:          	106.0
  | Standard Deviation:  	0.7
  | Mode:                	106
  | 
  | Insert range:        	50 - 127
  | 90th percentile:     	106
  | 75th percentile:     	106
  | 50th percentile:     	106
  | 25th percentile:     	106
  | 10th percentile:     	106
  \_____________________________________________________________________________
  /`````````````````````````````````````````````````````````````````````````````
  |BowtieAligner (sample: Modified) output message: 
  |------------------------------------------------ 
  | 
  | 202300 reads; of these:
  |   170214 (84.14%) were paired; of these:
  |     156647 (92.03%) aligned concordantly 0 times
  |     13567 (7.97%) aligned concordantly exactly 1 time
  |     0 (0.00%) aligned concordantly >1 times
  |     ----
  |     156647 pairs aligned concordantly 0 times; of these:
  |       0 (0.00%) aligned discordantly 1 time
  |     ----
  |     156647 pairs aligned 0 times concordantly or discordantly; of these:
  |       313294 mates make up the pairs; of these:
  |         159635 (50.95%) aligned 0 times
  |         153656 (49.05%) aligned exactly 1 time
  |         3 (0.00%) aligned >1 times
  |   32086 (15.86%) were unpaired; of these:
  |     110 (0.34%) aligned 0 times
  |     31976 (99.66%) aligned exactly 1 time
  |     0 (0.00%) aligned >1 times
  | 57.12% overall alignment rate
  \_____________________________________________________________________________
  /`````````````````````````````````````````````````````````````````````````````
  |MutationCounter_Modified (RNA: 034-EKC-A8C-75c-b-4-p) (sample: Modified) output message: 
  |---------------------------------------------------------------------------------------- 
  | 
  | Read lengths
  | --------------------
  | bin_range	frequency
  | [0,49]	0.002214
  | [50,99]	0.997786
  | [100,149]	0.000000
  | [150,199]	0.000000
  | [200,249]	0.000000
  | [250,299]	0.000000
  | [300,349]	0.000000
  | [350,399]	0.000000
  | [400,449]	0.000000
  | [450,499]	0.000000
  | [500,549]	0.000000
  | [550,599]	0.000000
  | [600,649]	0.000000
  | [650,699]	0.000000
  | [700,749]	0.000000
  | [750,799]	0.000000
  | [800,849]	0.000000
  | [850,899]	0.000000
  | [900,949]	0.000000
  | [950,999]	0.000000
  | >=1000	0.000000
  | --------------------
  | 
  | Mutations per read
  | --------------------
  | bin_left	frequency
  | 0	0.644627
  | 1	0.312271
  | 2	0.041380
  | 3	0.001707
  | 4	0.000015
  | 5	0.000000
  | 6	0.000000
  | 7	0.000000
  | 8	0.000000
  | 9	0.000000
  | 10	0.000000
  | 11	0.000000
  | 12	0.000000
  | 13	0.000000
  | 14	0.000000
  | 15	0.000000
  | 16	0.000000
  | 17	0.000000
  | 18	0.000000
  | 19	0.000000
  | 20	0.000000
  | --------------------
  \_____________________________________________________________________________
  /`````````````````````````````````````````````````````````````````````````````
  |MutationCounterGA_Modified (RNA: 034-EKC-A8C-75c-b-4-p) (sample: Modified) output message: 
  |------------------------------------------------------------------------------------------ 
  | 
  | Read lengths
  | --------------------
  | bin_range	frequency
  | [0,49]	0.002214
  | [50,99]	0.997786
  | [100,149]	0.000000
  | [150,199]	0.000000
  | [200,249]	0.000000
  | [250,299]	0.000000
  | [300,349]	0.000000
  | [350,399]	0.000000
  | [400,449]	0.000000
  | [450,499]	0.000000
  | [500,549]	0.000000
  | [550,599]	0.000000
  | [600,649]	0.000000
  | [650,699]	0.000000
  | [700,749]	0.000000
  | [750,799]	0.000000
  | [800,849]	0.000000
  | [850,899]	0.000000
  | [900,949]	0.000000
  | [950,999]	0.000000
  | >=1000	0.000000
  | --------------------
  | 
  | Mutations per read
  | --------------------
  | bin_left	frequency
  | 0	0.978093
  | 1	0.021772
  | 2	0.000131
  | 3	0.000005
  | 4	0.000000
  | 5	0.000000
  | 6	0.000000
  | 7	0.000000
  | 8	0.000000
  | 9	0.000000
  | 10	0.000000
  | 11	0.000000
  | 12	0.000000
  | 13	0.000000
  | 14	0.000000
  | 15	0.000000
  | 16	0.000000
  | 17	0.000000
  | 18	0.000000
  | 19	0.000000
  | 20	0.000000
  | --------------------
  \_____________________________________________________________________________
. . . done at 2025-10-14 17:53:43
Running CalcProfile at 2025-10-14 17:53:43 . . .
. . . done at 2025-10-14 17:53:43
Running NormProfile at 2025-10-14 17:53:43 . . .
/```````````````````````````````````````````````````````````````````````````````
|NormProfile (RNA: 034-EKC-A8C-75c-b-4-p) output message: 
|-------------------------------------------------------- 
| 
| Signal for U = 0.002 is below acceptable level. All U nts ignored
| Signal for G = 0.001 is below acceptable level. All G nts ignored
| calculated normalization factor: {'A': 0.029801, 'C': 0.0581725, 'U': nan, 'G': nan}
\_______________________________________________________________________________
. . . done at 2025-10-14 17:53:44
Running CalcProfile at 2025-10-14 17:53:44 . . .
. . . done at 2025-10-14 17:53:44
Running NormProfile at 2025-10-14 17:53:44 . . .
/```````````````````````````````````````````````````````````````````````````````
|NormProfile (RNA: 034-EKC-A8C-75c-b-4-p) output message: 
|-------------------------------------------------------- 
| 
| calculated normalization factor: {'A': nan, 'C': nan, 'U': nan, 'G': 0.002896, 'GPUR': 0.002615, 'GPYR': 0.0040230769230769235}
| ignoring n7 quality check.
\_______________________________________________________________________________
. . . done at 2025-10-14 17:53:44
Running TabToShape at 2025-10-14 17:53:44 . . .
. . . done at 2025-10-14 17:53:44
Running RenderFigures at 2025-10-14 17:53:44 . . .
/```````````````````````````````````````````````````````````````````````````````
|RenderFigures (RNA: 034-EKC-A8C-75c-b-4-p) output message: 
|---------------------------------------------------------- 
| 
| 
| DMS mode quality control checks:
| --------------------------------
| 
| ***************
| *   Nt = A    *
| ***************
| 
| Read depth check:
| 75.0% (9/12) nucleotides meet the minimum read depth of 5000
| FAIL: Read depths are too low for accurate reactivity profile creation.
|       Check alignment stats to see the amount of target sequence present
|       in each sample. Better target enrichment or recovery and/or
|       additional sequencing could help solve this problem.
| 
| Normalized rate check:
| PASS: Finite normalized rates present.
| 
| 
| ***************
| *   Nt = C    *
| ***************
| 
| Read depth check:
| 100.0% (3/3) nucleotides meet the minimum read depth of 5000
| PASS
| 
| Normalized rate check:
| PASS: Finite normalized rates present.
| 
| 
| ***************
| *   Nt = U    *
| ***************
| 
| Read depth check:
| 100.0% (13/13) nucleotides meet the minimum read depth of 5000
| PASS
| 
| Normalized rate check:
| FAIL: No finite normalized rates present.
|       This is either due to the nucleotide failing to
|       pass the normalization factor cutoff of at least
|       0.002 or due to the nucleotide having less than
|       20 nucleotides with quality reactivity information.
|       Please refer to the NormProfile section of this log
|       file for clarification
| 
| 
| ***************
| *   Nt = G    *
| ***************
| 
| Read depth check:
| 83.3% (10/12) nucleotides meet the minimum read depth of 5000
| PASS
| 
| Normalized rate check:
| FAIL: No finite normalized rates present.
|       This is either due to the nucleotide failing to
|       pass the normalization factor cutoff of at least
|       0.002 or due to the nucleotide having less than
|       20 nucleotides with quality reactivity information.
|       Please refer to the NormProfile section of this log
|       file for clarification
| 
| 
| -----------------------------------------------------------------
| 
|       Nucleotide passes all quality control checks: 
|         A: False
|         C: True
|         U: False
|         G: False
| 
| 
|       G and/or U FAILURE, but other reactivities may be usable
|       Possible causes:
|        - improper pH control during DMS reaction
|        - use of a different RT enzyme than MarathonRT
|        - poor reverse transcription conditions, resulting
|          in low adduct adduct read-through or detection
|        - very highly structured or protein bound RNA
| 
\_______________________________________________________________________________
. . . done at 2025-10-14 17:53:47
Running RenderMappedDepths at 2025-10-14 17:53:47 . . .
/```````````````````````````````````````````````````````````````````````````````
|RenderMappedDepths (RNA: 034-EKC-A8C-75c-b-4-p) output message: 
|--------------------------------------------------------------- 
| 
| Approximate maximum read depth for reads mapping near each amplicon primer pair
| (See *_mapped_depths.pdf for plots)
| (See *_per-amplicon_abundance.txt for exact numbers)
| 
| Modified:
|   pair forward                       left    right   reverse                       left    right   depth  
|   ---- ----------------------------- ------- ------- ----------------------------- ------- ------- ------ 
|   1    GGTGTAAGGGTGAAGTGTA           0       18      CTTCACCTTCATTACCTTTA          60      79      199k   
| 
\_______________________________________________________________________________
. . . done at 2025-10-14 17:53:48
ShapeMapper run completed at 2025-10-14 17:53:48.
WARNING: This RNA has a possible poor quality reactivity profile: 034-EKC-A8C-75c-b-4-p
See quality control checks above for details.
Deleting temp files. Use --output-temp to retain temp files.
################################################################################
# 3 - Verify FASTQ inputs
################################################################################
-rw-r--r-- 1 ekc5108 b1044 6.1M Sep 17  2024 /projects/b1044/Sequencing/SHAPE-Seq/EKC/230617_M05164_0145_000000000-L4LWB/035-EKC-A8C-75c-b-5-p_S35_L001_R1_001.fastq.gz
-rw-r--r-- 1 ekc5108 b1044 7.4M Sep 17  2024 /projects/b1044/Sequencing/SHAPE-Seq/EKC/230617_M05164_0145_000000000-L4LWB/035-EKC-A8C-75c-b-5-p_S35_L001_R2_001.fastq.gz
################################################################################
# 4 - Verify created FASTA
################################################################################
>035-EKC-A8C-75c-b-5-p
ggtgtaagggtgaagtgtaAGGTTGACCTTTTGAATAGTGATTCAGGAGGTTAATGGAAGtaaaggtaatgaaggtgaag
################################################################################
# 5 - Create shapemapper
################################################################################
Command: /projects/b1044/Software/shapemapper2-2.3/shapemapper --name 035-EKC-A8C-75c-b-5-p --target artifacts/035-EKC-A8C-75c-b-5-p/target.fa --out artifacts/035-EKC-A8C-75c-b-5-p --modified --R1 /projects/b1044/Sequencing/SHAPE-Seq/EKC/230617_M05164_0145_000000000-L4LWB/035-EKC-A8C-75c-b-5-p_S35_L001_R1_001.fastq.gz --R2 /projects/b1044/Sequencing/SHAPE-Seq/EKC/230617_M05164_0145_000000000-L4LWB/035-EKC-A8C-75c-b-5-p_S35_L001_R2_001.fastq.gz --amplicon --dms --N7 --bypass_filters --per-read-histograms
################################################################################
# 6 - Run shapemapper
################################################################################

################################################################################

Started ShapeMapper v2.3.0 at 2025-10-14 17:53:49
Output will be logged to 035-EKC-A8C-75c-b-5-p_shapemapper_log.txt
Running from directory: /gpfs/projects/b1044/Computational_Output/EKC/EKC.01_SHAPE_standardization/EKC.01.065.refactoring_data_analysis/nerd/examples/all_mutcounts/mut_count/mut_count___cfg-cc5447b
args:  --name 035-EKC-A8C-75c-b-5-p --target artifacts/035-EKC-A8C-75c-b-5-p/target.fa --out artifacts/035-EKC-A8C-75c-b-5-p --modified --R1 /projects/b1044/Sequencing/SHAPE-Seq/EKC/230617_M05164_0145_000000000-L4LWB/035-EKC-A8C-75c-b-5-p_S3... --R2 /projects/b1044/Sequencing/SHAPE-Seq/EKC/230617_M05164_0145_000000000-L4LWB/035-EKC-A8C-75c-b-5-p_S3... --amplicon --dms --N7 --bypass_filters --per-read-histograms
--bypass_filters flag passed - ignoring low N7 reactivity and setting per-NT threshold to 1.
Using default DMS max-bg of 0.02
	You can manually override using the max-bg flag
Created pipeline at 2025-10-14 17:53:49
Running PrimerLocator at 2025-10-14 17:53:49 . . .
. . . done at 2025-10-14 17:53:49
Running FastaFormatChecker at 2025-10-14 17:53:49 . . .
. . . done at 2025-10-14 17:53:49
Running BowtieIndexBuilder at 2025-10-14 17:53:49 . . .
. . . done at 2025-10-14 17:53:50
Running process group 4 at 2025-10-14 17:53:50 . . .
  Including these components:
    ProgressMonitor . . . started at 2025-10-14 17:53:50
    QualityTrimmer1 . . . started at 2025-10-14 17:53:50
    QualityTrimmer2 . . . started at 2025-10-14 17:53:50
    Interleaver . . . started at 2025-10-14 17:53:50
    Merger . . . started at 2025-10-14 17:53:50
    Tab6Interleaver . . . started at 2025-10-14 17:53:50
    BowtieAligner . . . started at 2025-10-14 17:53:50
    MutationParser_Modified . . . started at 2025-10-14 17:53:50
    MutationParserGA_Modified . . . started at 2025-10-14 17:53:50
    MutationCounter_Modified . . . started at 2025-10-14 17:53:50
    MutationCounterGA_Modified . . . started at 2025-10-14 17:53:50
  884KiB [=====>                                          ] 14% ETA 0:00:05       1.22MiB [========>                                       ] 20% ETA 0:00:07      1.61MiB [===========>                                    ] 26% ETA 0:00:08      1.93MiB [=============>                                  ] 31% ETA 0:00:08      2.37MiB [=================>                              ] 39% ETA 0:00:07      2.72MiB [====================>                           ] 45% ETA 0:00:07      2.76MiB [====================>                           ] 45% ETA 0:00:08      3.10MiB [=======================>                        ] 51% ETA 0:00:07      3.42MiB [=========================>                      ] 56% ETA 0:00:073.43MiB [=========================>                      ] 56% ETA 0:00:07  3.80MiB [=============================>                  ] 63% ETA 0:00:073.81MiB [=============================>                  ] 63% ETA 0:00:07  4.09MiB [===============================>                ] 67% ETA 0:00:07      4.48MiB [==================================>             ] 74% ETA 0:00:054.49MiB [==================================>             ] 74% ETA 0:00:05  4.81MiB [====================================>           ] 79% ETA 0:00:04      5.12MiB [=======================================>        ] 85% ETA 0:00:03      5.47MiB [==========================================>     ] 90% ETA 0:00:025.48MiB [==========================================>     ] 91% ETA 0:00:02  5.89MiB [=============================================>  ] 97% ETA 0:00:006.02MiB [==============================================>] 100%  /`````````````````````````````````````````````````````````````````````````````
  |Merger (sample: Modified) output message: 
  |----------------------------------------- 
  | 
  | java -Djava.library.path=/gpfs/projects/b1044/Software/shapemapper2-2.3/internals/thirdparty/miniconda/envs/shapemapper_make/opt/bbmap-37.78/jni/ -ea -Xmx1000m -Xmx1000m -cp /gpfs/projects/b1044/Software/shapemapper2-2.3/internals/thirdparty/miniconda/envs/shapemapper_make/opt/bbmap-37.78/current/ jgi.BBMerge vstrict=t in=stdin out=stdout outu=stdout interleaved=t usejni=t t=4
  | Executing jgi.BBMerge [vstrict=t, in=stdin, out=stdout, outu=stdout, interleaved=t, usejni=t, t=4]
  | Version 37.78 [vstrict=t, in=stdin, out=stdout, outu=stdout, interleaved=t, usejni=t, t=4]
  | 
  | Revised arguments: [maxbad=4, margin=3, minqo=8, qualiters=2, ratiomode=t, flatmode=f, minentropy=52, minoverlap=12, minoverlap0=4, maxratio=0.05, ratiomargin=12, ratiooffset=0.5, ratiominoverlapreduction=4, efilter=2, pfilter=0.008, minsecondratio=0.16, minapproxoverlap=22, in=stdin, out=stdout, outu=stdout, interleaved=t, usejni=t, t=4]
  | 
  | Set INTERLEAVED to true
  | Set threads to 4
  | Writing mergable reads merged.
  | Unspecified format for output stdout; defaulting to fastq.
  | Unspecified format for output stdout; defaulting to fastq.
  | Started output threads.
  | Unspecified format for input stdin; defaulting to fastq.
  | Total time: 24.182 seconds.
  | 
  | Pairs:               	233024
  | Joined:              	36252   	15.557%
  | Ambiguous:           	196772   	84.443%
  | No Solution:         	0       	0.000%
  | Too Short:           	0       	0.000%
  | 
  | Avg Insert:          	106.0
  | Standard Deviation:  	0.5
  | Mode:                	106
  | 
  | Insert range:        	50 - 112
  | 90th percentile:     	106
  | 75th percentile:     	106
  | 50th percentile:     	106
  | 25th percentile:     	106
  | 10th percentile:     	106
  \_____________________________________________________________________________
  /`````````````````````````````````````````````````````````````````````````````
  |BowtieAligner (sample: Modified) output message: 
  |------------------------------------------------ 
  | 
  | 233024 reads; of these:
  |   196772 (84.44%) were paired; of these:
  |     180710 (91.84%) aligned concordantly 0 times
  |     16061 (8.16%) aligned concordantly exactly 1 time
  |     1 (0.00%) aligned concordantly >1 times
  |     ----
  |     180710 pairs aligned concordantly 0 times; of these:
  |       0 (0.00%) aligned discordantly 1 time
  |     ----
  |     180710 pairs aligned 0 times concordantly or discordantly; of these:
  |       361420 mates make up the pairs; of these:
  |         184517 (51.05%) aligned 0 times
  |         176897 (48.94%) aligned exactly 1 time
  |         6 (0.00%) aligned >1 times
  |   36252 (15.56%) were unpaired; of these:
  |     146 (0.40%) aligned 0 times
  |     36106 (99.60%) aligned exactly 1 time
  |     0 (0.00%) aligned >1 times
  | 57.03% overall alignment rate
  \_____________________________________________________________________________
  /`````````````````````````````````````````````````````````````````````````````
  |MutationCounter_Modified (RNA: 035-EKC-A8C-75c-b-5-p) (sample: Modified) output message: 
  |---------------------------------------------------------------------------------------- 
  | 
  | Read lengths
  | --------------------
  | bin_range	frequency
  | [0,49]	0.002152
  | [50,99]	0.997848
  | [100,149]	0.000000
  | [150,199]	0.000000
  | [200,249]	0.000000
  | [250,299]	0.000000
  | [300,349]	0.000000
  | [350,399]	0.000000
  | [400,449]	0.000000
  | [450,499]	0.000000
  | [500,549]	0.000000
  | [550,599]	0.000000
  | [600,649]	0.000000
  | [650,699]	0.000000
  | [700,749]	0.000000
  | [750,799]	0.000000
  | [800,849]	0.000000
  | [850,899]	0.000000
  | [900,949]	0.000000
  | [950,999]	0.000000
  | >=1000	0.000000
  | --------------------
  | 
  | Mutations per read
  | --------------------
  | bin_left	frequency
  | 0	0.628207
  | 1	0.324672
  | 2	0.044973
  | 3	0.002104
  | 4	0.000044
  | 5	0.000000
  | 6	0.000000
  | 7	0.000000
  | 8	0.000000
  | 9	0.000000
  | 10	0.000000
  | 11	0.000000
  | 12	0.000000
  | 13	0.000000
  | 14	0.000000
  | 15	0.000000
  | 16	0.000000
  | 17	0.000000
  | 18	0.000000
  | 19	0.000000
  | 20	0.000000
  | --------------------
  \_____________________________________________________________________________
  /`````````````````````````````````````````````````````````````````````````````
  |MutationCounterGA_Modified (RNA: 035-EKC-A8C-75c-b-5-p) (sample: Modified) output message: 
  |------------------------------------------------------------------------------------------ 
  | 
  | Read lengths
  | --------------------
  | bin_range	frequency
  | [0,49]	0.002152
  | [50,99]	0.997848
  | [100,149]	0.000000
  | [150,199]	0.000000
  | [200,249]	0.000000
  | [250,299]	0.000000
  | [300,349]	0.000000
  | [350,399]	0.000000
  | [400,449]	0.000000
  | [450,499]	0.000000
  | [500,549]	0.000000
  | [550,599]	0.000000
  | [600,649]	0.000000
  | [650,699]	0.000000
  | [700,749]	0.000000
  | [750,799]	0.000000
  | [800,849]	0.000000
  | [850,899]	0.000000
  | [900,949]	0.000000
  | [950,999]	0.000000
  | >=1000	0.000000
  | --------------------
  | 
  | Mutations per read
  | --------------------
  | bin_left	frequency
  | 0	0.976562
  | 1	0.023255
  | 2	0.000179
  | 3	0.000004
  | 4	0.000000
  | 5	0.000000
  | 6	0.000000
  | 7	0.000000
  | 8	0.000000
  | 9	0.000000
  | 10	0.000000
  | 11	0.000000
  | 12	0.000000
  | 13	0.000000
  | 14	0.000000
  | 15	0.000000
  | 16	0.000000
  | 17	0.000000
  | 18	0.000000
  | 19	0.000000
  | 20	0.000000
  | --------------------
  \_____________________________________________________________________________
. . . done at 2025-10-14 17:54:14
Running CalcProfile at 2025-10-14 17:54:14 . . .
. . . done at 2025-10-14 17:54:15
Running NormProfile at 2025-10-14 17:54:15 . . .
/```````````````````````````````````````````````````````````````````````````````
|NormProfile (RNA: 035-EKC-A8C-75c-b-5-p) output message: 
|-------------------------------------------------------- 
| 
| Signal for G = 0.002 is below acceptable level. All G nts ignored
| calculated normalization factor: {'A': 0.030855, 'C': 0.0602625, 'U': 0.002174, 'G': nan}
\_______________________________________________________________________________
. . . done at 2025-10-14 17:54:15
Running CalcProfile at 2025-10-14 17:54:15 . . .
. . . done at 2025-10-14 17:54:15
Running NormProfile at 2025-10-14 17:54:15 . . .
/```````````````````````````````````````````````````````````````````````````````
|NormProfile (RNA: 035-EKC-A8C-75c-b-5-p) output message: 
|-------------------------------------------------------- 
| 
| calculated normalization factor: {'A': nan, 'C': nan, 'U': nan, 'G': 0.00315375, 'GPUR': 0.002764, 'GPYR': 0.004252307692307692}
| ignoring n7 quality check.
\_______________________________________________________________________________
. . . done at 2025-10-14 17:54:15
Running TabToShape at 2025-10-14 17:54:15 . . .
. . . done at 2025-10-14 17:54:16
Running RenderFigures at 2025-10-14 17:54:16 . . .
/```````````````````````````````````````````````````````````````````````````````
|RenderFigures (RNA: 035-EKC-A8C-75c-b-5-p) output message: 
|---------------------------------------------------------- 
| 
| 
| DMS mode quality control checks:
| --------------------------------
| 
| ***************
| *   Nt = A    *
| ***************
| 
| Read depth check:
| 75.0% (9/12) nucleotides meet the minimum read depth of 5000
| FAIL: Read depths are too low for accurate reactivity profile creation.
|       Check alignment stats to see the amount of target sequence present
|       in each sample. Better target enrichment or recovery and/or
|       additional sequencing could help solve this problem.
| 
| Normalized rate check:
| PASS: Finite normalized rates present.
| 
| 
| ***************
| *   Nt = C    *
| ***************
| 
| Read depth check:
| 100.0% (3/3) nucleotides meet the minimum read depth of 5000
| PASS
| 
| Normalized rate check:
| PASS: Finite normalized rates present.
| 
| 
| ***************
| *   Nt = U    *
| ***************
| 
| Read depth check:
| 100.0% (13/13) nucleotides meet the minimum read depth of 5000
| PASS
| 
| Normalized rate check:
| PASS: Finite normalized rates present.
| 
| 
| ***************
| *   Nt = G    *
| ***************
| 
| Read depth check:
| 83.3% (10/12) nucleotides meet the minimum read depth of 5000
| PASS
| 
| Normalized rate check:
| FAIL: No finite normalized rates present.
|       This is either due to the nucleotide failing to
|       pass the normalization factor cutoff of at least
|       0.002 or due to the nucleotide having less than
|       20 nucleotides with quality reactivity information.
|       Please refer to the NormProfile section of this log
|       file for clarification
| 
| 
| -----------------------------------------------------------------
| 
|       Nucleotide passes all quality control checks: 
|         A: False
|         C: True
|         U: True
|         G: False
| 
| 
|       G and/or U FAILURE, but other reactivities may be usable
|       Possible causes:
|        - improper pH control during DMS reaction
|        - use of a different RT enzyme than MarathonRT
|        - poor reverse transcription conditions, resulting
|          in low adduct adduct read-through or detection
|        - very highly structured or protein bound RNA
| 
\_______________________________________________________________________________
. . . done at 2025-10-14 17:54:18
Running RenderMappedDepths at 2025-10-14 17:54:18 . . .
/```````````````````````````````````````````````````````````````````````````````
|RenderMappedDepths (RNA: 035-EKC-A8C-75c-b-5-p) output message: 
|--------------------------------------------------------------- 
| 
| Approximate maximum read depth for reads mapping near each amplicon primer pair
| (See *_mapped_depths.pdf for plots)
| (See *_per-amplicon_abundance.txt for exact numbers)
| 
| Modified:
|   pair forward                       left    right   reverse                       left    right   depth  
|   ---- ----------------------------- ------- ------- ----------------------------- ------- ------- ------ 
|   1    GGTGTAAGGGTGAAGTGTA           0       18      CTTCACCTTCATTACCTTTA          60      79      229k   
| 
\_______________________________________________________________________________
. . . done at 2025-10-14 17:54:19
ShapeMapper run completed at 2025-10-14 17:54:19.
WARNING: This RNA has a possible poor quality reactivity profile: 035-EKC-A8C-75c-b-5-p
See quality control checks above for details.
Deleting temp files. Use --output-temp to retain temp files.
################################################################################
# 3 - Verify FASTQ inputs
################################################################################
-rw-r--r-- 1 ekc5108 b1044 6.7M Sep 17  2024 /projects/b1044/Sequencing/SHAPE-Seq/EKC/230617_M05164_0145_000000000-L4LWB/036-EKC-A8C-75c-b-6-p_S36_L001_R1_001.fastq.gz
-rw-r--r-- 1 ekc5108 b1044 8.1M Sep 17  2024 /projects/b1044/Sequencing/SHAPE-Seq/EKC/230617_M05164_0145_000000000-L4LWB/036-EKC-A8C-75c-b-6-p_S36_L001_R2_001.fastq.gz
################################################################################
# 4 - Verify created FASTA
################################################################################
>036-EKC-A8C-75c-b-6-p
ggtgtaagggtgaagtgtaAGGTTGACCTTTTGAATAGTGATTCAGGAGGTTAATGGAAGtaaaggtaatgaaggtgaag
################################################################################
# 5 - Create shapemapper
################################################################################
Command: /projects/b1044/Software/shapemapper2-2.3/shapemapper --name 036-EKC-A8C-75c-b-6-p --target artifacts/036-EKC-A8C-75c-b-6-p/target.fa --out artifacts/036-EKC-A8C-75c-b-6-p --modified --R1 /projects/b1044/Sequencing/SHAPE-Seq/EKC/230617_M05164_0145_000000000-L4LWB/036-EKC-A8C-75c-b-6-p_S36_L001_R1_001.fastq.gz --R2 /projects/b1044/Sequencing/SHAPE-Seq/EKC/230617_M05164_0145_000000000-L4LWB/036-EKC-A8C-75c-b-6-p_S36_L001_R2_001.fastq.gz --amplicon --dms --N7 --bypass_filters --per-read-histograms
################################################################################
# 6 - Run shapemapper
################################################################################

################################################################################

Started ShapeMapper v2.3.0 at 2025-10-14 17:54:20
Output will be logged to 036-EKC-A8C-75c-b-6-p_shapemapper_log.txt
Running from directory: /gpfs/projects/b1044/Computational_Output/EKC/EKC.01_SHAPE_standardization/EKC.01.065.refactoring_data_analysis/nerd/examples/all_mutcounts/mut_count/mut_count___cfg-cc5447b
args:  --name 036-EKC-A8C-75c-b-6-p --target artifacts/036-EKC-A8C-75c-b-6-p/target.fa --out artifacts/036-EKC-A8C-75c-b-6-p --modified --R1 /projects/b1044/Sequencing/SHAPE-Seq/EKC/230617_M05164_0145_000000000-L4LWB/036-EKC-A8C-75c-b-6-p_S3... --R2 /projects/b1044/Sequencing/SHAPE-Seq/EKC/230617_M05164_0145_000000000-L4LWB/036-EKC-A8C-75c-b-6-p_S3... --amplicon --dms --N7 --bypass_filters --per-read-histograms
--bypass_filters flag passed - ignoring low N7 reactivity and setting per-NT threshold to 1.
Using default DMS max-bg of 0.02
	You can manually override using the max-bg flag
Created pipeline at 2025-10-14 17:54:20
Running PrimerLocator at 2025-10-14 17:54:20 . . .
. . . done at 2025-10-14 17:54:20
Running FastaFormatChecker at 2025-10-14 17:54:20 . . .
. . . done at 2025-10-14 17:54:20
Running BowtieIndexBuilder at 2025-10-14 17:54:20 . . .
. . . done at 2025-10-14 17:54:21
Running process group 4 at 2025-10-14 17:54:21 . . .
  Including these components:
    ProgressMonitor . . . started at 2025-10-14 17:54:21
    QualityTrimmer1 . . . started at 2025-10-14 17:54:21
    QualityTrimmer2 . . . started at 2025-10-14 17:54:21
    Interleaver . . . started at 2025-10-14 17:54:21
    Merger . . . started at 2025-10-14 17:54:21
    Tab6Interleaver . . . started at 2025-10-14 17:54:21
    BowtieAligner . . . started at 2025-10-14 17:54:21
    MutationParser_Modified . . . started at 2025-10-14 17:54:21
    MutationParserGA_Modified . . . started at 2025-10-14 17:54:21
    MutationCounter_Modified . . . started at 2025-10-14 17:54:21
    MutationCounterGA_Modified . . . started at 2025-10-14 17:54:21
  860KiB [====>                                           ] 12% ETA 0:00:06       1.21MiB [=======>                                        ] 18% ETA 0:00:08      1.61MiB [==========>                                     ] 24% ETA 0:00:09      2.04MiB [=============>                                  ] 30% ETA 0:00:09      2.36MiB [===============>                                ] 35% ETA 0:00:09      2.77MiB [==================>                             ] 41% ETA 0:00:08      3.15MiB [=====================>                          ] 47% ETA 0:00:07      3.45MiB [=======================>                        ] 51% ETA 0:00:07      3.83MiB [==========================>                     ] 57% ETA 0:00:083.84MiB [==========================>                     ] 57% ETA 0:00:08  4.18MiB [============================>                   ] 62% ETA 0:00:084.18MiB [============================>                   ] 62% ETA 0:00:08  4.50MiB [===============================>                ] 67% ETA 0:00:07      4.83MiB [=================================>              ] 72% ETA 0:00:074.84MiB [=================================>              ] 72% ETA 0:00:07  5.50MiB [======================================>         ] 82% ETA 0:00:045.51MiB [======================================>         ] 82% ETA 0:00:04  5.83MiB [========================================>       ] 87% ETA 0:00:035.84MiB [========================================>       ] 87% ETA 0:00:03  6.19MiB [===========================================>    ] 92% ETA 0:00:026.35MiB [============================================>   ] 95% ETA 0:00:01  6.63MiB [==============================================> ] 99% ETA 0:00:006.64MiB [==============================================> ] 99% ETA 0:00:006.68MiB [==============================================>] 100%  /`````````````````````````````````````````````````````````````````````````````
  |Merger (sample: Modified) output message: 
  |----------------------------------------- 
  | 
  | java -Djava.library.path=/gpfs/projects/b1044/Software/shapemapper2-2.3/internals/thirdparty/miniconda/envs/shapemapper_make/opt/bbmap-37.78/jni/ -ea -Xmx1000m -Xmx1000m -cp /gpfs/projects/b1044/Software/shapemapper2-2.3/internals/thirdparty/miniconda/envs/shapemapper_make/opt/bbmap-37.78/current/ jgi.BBMerge vstrict=t in=stdin out=stdout outu=stdout interleaved=t usejni=t t=4
  | Executing jgi.BBMerge [vstrict=t, in=stdin, out=stdout, outu=stdout, interleaved=t, usejni=t, t=4]
  | Version 37.78 [vstrict=t, in=stdin, out=stdout, outu=stdout, interleaved=t, usejni=t, t=4]
  | 
  | Revised arguments: [maxbad=4, margin=3, minqo=8, qualiters=2, ratiomode=t, flatmode=f, minentropy=52, minoverlap=12, minoverlap0=4, maxratio=0.05, ratiomargin=12, ratiooffset=0.5, ratiominoverlapreduction=4, efilter=2, pfilter=0.008, minsecondratio=0.16, minapproxoverlap=22, in=stdin, out=stdout, outu=stdout, interleaved=t, usejni=t, t=4]
  | 
  | Set INTERLEAVED to true
  | Set threads to 4
  | Writing mergable reads merged.
  | Unspecified format for output stdout; defaulting to fastq.
  | Unspecified format for output stdout; defaulting to fastq.
  | Started output threads.
  | Unspecified format for input stdin; defaulting to fastq.
  | Total time: 29.823 seconds.
  | 
  | Pairs:               	258424
  | Joined:              	39875   	15.430%
  | Ambiguous:           	218549   	84.570%
  | No Solution:         	0       	0.000%
  | Too Short:           	0       	0.000%
  | 
  | Avg Insert:          	106.0
  | Standard Deviation:  	0.7
  | Mode:                	106
  | 
  | Insert range:        	50 - 133
  | 90th percentile:     	106
  | 75th percentile:     	106
  | 50th percentile:     	106
  | 25th percentile:     	106
  | 10th percentile:     	106
  \_____________________________________________________________________________
  /`````````````````````````````````````````````````````````````````````````````
  |BowtieAligner (sample: Modified) output message: 
  |------------------------------------------------ 
  | 
  | 258424 reads; of these:
  |   218549 (84.57%) were paired; of these:
  |     200573 (91.77%) aligned concordantly 0 times
  |     17975 (8.22%) aligned concordantly exactly 1 time
  |     1 (0.00%) aligned concordantly >1 times
  |     ----
  |     200573 pairs aligned concordantly 0 times; of these:
  |       1 (0.00%) aligned discordantly 1 time
  |     ----
  |     200572 pairs aligned 0 times concordantly or discordantly; of these:
  |       401144 mates make up the pairs; of these:
  |         204813 (51.06%) aligned 0 times
  |         196317 (48.94%) aligned exactly 1 time
  |         14 (0.00%) aligned >1 times
  |   39875 (15.43%) were unpaired; of these:
  |     166 (0.42%) aligned 0 times
  |     39709 (99.58%) aligned exactly 1 time
  |     0 (0.00%) aligned >1 times
  | 57.03% overall alignment rate
  \_____________________________________________________________________________
  /`````````````````````````````````````````````````````````````````````````````
  |MutationCounter_Modified (RNA: 036-EKC-A8C-75c-b-6-p) (sample: Modified) output message: 
  |---------------------------------------------------------------------------------------- 
  | 
  | Read lengths
  | --------------------
  | bin_range	frequency
  | [0,49]	0.002256
  | [50,99]	0.997744
  | [100,149]	0.000000
  | [150,199]	0.000000
  | [200,249]	0.000000
  | [250,299]	0.000000
  | [300,349]	0.000000
  | [350,399]	0.000000
  | [400,449]	0.000000
  | [450,499]	0.000000
  | [500,549]	0.000000
  | [550,599]	0.000000
  | [600,649]	0.000000
  | [650,699]	0.000000
  | [700,749]	0.000000
  | [750,799]	0.000000
  | [800,849]	0.000000
  | [850,899]	0.000000
  | [900,949]	0.000000
  | [950,999]	0.000000
  | >=1000	0.000000
  | --------------------
  | 
  | Mutations per read
  | --------------------
  | bin_left	frequency
  | 0	0.633868
  | 1	0.319119
  | 2	0.044883
  | 3	0.002098
  | 4	0.000024
  | 5	0.000000
  | 6	0.000000
  | 7	0.000000
  | 8	0.000004
  | 9	0.000004
  | 10	0.000000
  | 11	0.000000
  | 12	0.000000
  | 13	0.000000
  | 14	0.000000
  | 15	0.000000
  | 16	0.000000
  | 17	0.000000
  | 18	0.000000
  | 19	0.000000
  | 20	0.000000
  | --------------------
  \_____________________________________________________________________________
  /`````````````````````````````````````````````````````````````````````````````
  |MutationCounterGA_Modified (RNA: 036-EKC-A8C-75c-b-6-p) (sample: Modified) output message: 
  |------------------------------------------------------------------------------------------ 
  | 
  | Read lengths
  | --------------------
  | bin_range	frequency
  | [0,49]	0.002256
  | [50,99]	0.997744
  | [100,149]	0.000000
  | [150,199]	0.000000
  | [200,249]	0.000000
  | [250,299]	0.000000
  | [300,349]	0.000000
  | [350,399]	0.000000
  | [400,449]	0.000000
  | [450,499]	0.000000
  | [500,549]	0.000000
  | [550,599]	0.000000
  | [600,649]	0.000000
  | [650,699]	0.000000
  | [700,749]	0.000000
  | [750,799]	0.000000
  | [800,849]	0.000000
  | [850,899]	0.000000
  | [900,949]	0.000000
  | [950,999]	0.000000
  | >=1000	0.000000
  | --------------------
  | 
  | Mutations per read
  | --------------------
  | bin_left	frequency
  | 0	0.977785
  | 1	0.022050
  | 2	0.000154
  | 3	0.000004
  | 4	0.000000
  | 5	0.000000
  | 6	0.000000
  | 7	0.000000
  | 8	0.000004
  | 9	0.000004
  | 10	0.000000
  | 11	0.000000
  | 12	0.000000
  | 13	0.000000
  | 14	0.000000
  | 15	0.000000
  | 16	0.000000
  | 17	0.000000
  | 18	0.000000
  | 19	0.000000
  | 20	0.000000
  | --------------------
  \_____________________________________________________________________________
. . . done at 2025-10-14 17:54:51
Running CalcProfile at 2025-10-14 17:54:51 . . .
. . . done at 2025-10-14 17:54:51
Running NormProfile at 2025-10-14 17:54:51 . . .
/```````````````````````````````````````````````````````````````````````````````
|NormProfile (RNA: 036-EKC-A8C-75c-b-6-p) output message: 
|-------------------------------------------------------- 
| 
| Signal for G = 0.001 is below acceptable level. All G nts ignored
| calculated normalization factor: {'A': 0.031457, 'C': 0.0573345, 'U': 0.002026, 'G': nan}
\_______________________________________________________________________________
. . . done at 2025-10-14 17:54:51
Running CalcProfile at 2025-10-14 17:54:51 . . .
. . . done at 2025-10-14 17:54:52
Running NormProfile at 2025-10-14 17:54:52 . . .
/```````````````````````````````````````````````````````````````````````````````
|NormProfile (RNA: 036-EKC-A8C-75c-b-6-p) output message: 
|-------------------------------------------------------- 
| 
| calculated normalization factor: {'A': nan, 'C': nan, 'U': nan, 'G': 0.00298, 'GPUR': 0.002548, 'GPYR': 0.00392}
| ignoring n7 quality check.
\_______________________________________________________________________________
. . . done at 2025-10-14 17:54:52
Running TabToShape at 2025-10-14 17:54:52 . . .
. . . done at 2025-10-14 17:54:52
Running RenderFigures at 2025-10-14 17:54:52 . . .
/```````````````````````````````````````````````````````````````````````````````
|RenderFigures (RNA: 036-EKC-A8C-75c-b-6-p) output message: 
|---------------------------------------------------------- 
| 
| 
| DMS mode quality control checks:
| --------------------------------
| 
| ***************
| *   Nt = A    *
| ***************
| 
| Read depth check:
| 75.0% (9/12) nucleotides meet the minimum read depth of 5000
| FAIL: Read depths are too low for accurate reactivity profile creation.
|       Check alignment stats to see the amount of target sequence present
|       in each sample. Better target enrichment or recovery and/or
|       additional sequencing could help solve this problem.
| 
| Normalized rate check:
| PASS: Finite normalized rates present.
| 
| 
| ***************
| *   Nt = C    *
| ***************
| 
| Read depth check:
| 100.0% (3/3) nucleotides meet the minimum read depth of 5000
| PASS
| 
| Normalized rate check:
| PASS: Finite normalized rates present.
| 
| 
| ***************
| *   Nt = U    *
| ***************
| 
| Read depth check:
| 100.0% (13/13) nucleotides meet the minimum read depth of 5000
| PASS
| 
| Normalized rate check:
| PASS: Finite normalized rates present.
| 
| 
| ***************
| *   Nt = G    *
| ***************
| 
| Read depth check:
| 83.3% (10/12) nucleotides meet the minimum read depth of 5000
| PASS
| 
| Normalized rate check:
| FAIL: No finite normalized rates present.
|       This is either due to the nucleotide failing to
|       pass the normalization factor cutoff of at least
|       0.002 or due to the nucleotide having less than
|       20 nucleotides with quality reactivity information.
|       Please refer to the NormProfile section of this log
|       file for clarification
| 
| 
| -----------------------------------------------------------------
| 
|       Nucleotide passes all quality control checks: 
|         A: False
|         C: True
|         U: True
|         G: False
| 
| 
|       G and/or U FAILURE, but other reactivities may be usable
|       Possible causes:
|        - improper pH control during DMS reaction
|        - use of a different RT enzyme than MarathonRT
|        - poor reverse transcription conditions, resulting
|          in low adduct adduct read-through or detection
|        - very highly structured or protein bound RNA
| 
\_______________________________________________________________________________
. . . done at 2025-10-14 17:54:55
Running RenderMappedDepths at 2025-10-14 17:54:55 . . .
/```````````````````````````````````````````````````````````````````````````````
|RenderMappedDepths (RNA: 036-EKC-A8C-75c-b-6-p) output message: 
|--------------------------------------------------------------- 
| 
| Approximate maximum read depth for reads mapping near each amplicon primer pair
| (See *_mapped_depths.pdf for plots)
| (See *_per-amplicon_abundance.txt for exact numbers)
| 
| Modified:
|   pair forward                       left    right   reverse                       left    right   depth  
|   ---- ----------------------------- ------- ------- ----------------------------- ------- ------- ------ 
|   1    GGTGTAAGGGTGAAGTGTA           0       18      CTTCACCTTCATTACCTTTA          60      79      254k   
| 
\_______________________________________________________________________________
. . . done at 2025-10-14 17:54:55
ShapeMapper run completed at 2025-10-14 17:54:55.
WARNING: This RNA has a possible poor quality reactivity profile: 036-EKC-A8C-75c-b-6-p
See quality control checks above for details.
Deleting temp files. Use --output-temp to retain temp files.
################################################################################
# 3 - Verify FASTQ inputs
################################################################################
-rw-r--r-- 1 ekc5108 b1044 5.7M Jun  8  2023 /projects/b1044/Sequencing/SHAPE-Seq/EKC/230607_M05164_0144_000000000-L3FLD/046-EKC-A8C-75c-b-6-m_S46_L001_R1_001.fastq.gz
-rw-r--r-- 1 ekc5108 b1044 7.5M Jun  8  2023 /projects/b1044/Sequencing/SHAPE-Seq/EKC/230607_M05164_0144_000000000-L3FLD/046-EKC-A8C-75c-b-6-m_S46_L001_R2_001.fastq.gz
################################################################################
# 4 - Verify created FASTA
################################################################################
>046-EKC-A8C-75c-b-6-m
ggtgtaagggtgaagtgtaAGGTTGACCTTTTGAATAGTGATTCAGGAGGTTAATGGAAGtaaaggtaatgaaggtgaag
################################################################################
# 5 - Create shapemapper
################################################################################
Command: /projects/b1044/Software/shapemapper2-2.3/shapemapper --name 046-EKC-A8C-75c-b-6-m --target artifacts/046-EKC-A8C-75c-b-6-m/target.fa --out artifacts/046-EKC-A8C-75c-b-6-m --modified --R1 /projects/b1044/Sequencing/SHAPE-Seq/EKC/230607_M05164_0144_000000000-L3FLD/046-EKC-A8C-75c-b-6-m_S46_L001_R1_001.fastq.gz --R2 /projects/b1044/Sequencing/SHAPE-Seq/EKC/230607_M05164_0144_000000000-L3FLD/046-EKC-A8C-75c-b-6-m_S46_L001_R2_001.fastq.gz --amplicon --dms --N7 --bypass_filters --per-read-histograms
################################################################################
# 6 - Run shapemapper
################################################################################

################################################################################

Started ShapeMapper v2.3.0 at 2025-10-14 17:54:57
Output will be logged to 046-EKC-A8C-75c-b-6-m_shapemapper_log.txt
Running from directory: /gpfs/projects/b1044/Computational_Output/EKC/EKC.01_SHAPE_standardization/EKC.01.065.refactoring_data_analysis/nerd/examples/all_mutcounts/mut_count/mut_count___cfg-cc5447b
args:  --name 046-EKC-A8C-75c-b-6-m --target artifacts/046-EKC-A8C-75c-b-6-m/target.fa --out artifacts/046-EKC-A8C-75c-b-6-m --modified --R1 /projects/b1044/Sequencing/SHAPE-Seq/EKC/230607_M05164_0144_000000000-L3FLD/046-EKC-A8C-75c-b-6-m_S4... --R2 /projects/b1044/Sequencing/SHAPE-Seq/EKC/230607_M05164_0144_000000000-L3FLD/046-EKC-A8C-75c-b-6-m_S4... --amplicon --dms --N7 --bypass_filters --per-read-histograms
--bypass_filters flag passed - ignoring low N7 reactivity and setting per-NT threshold to 1.
Using default DMS max-bg of 0.02
	You can manually override using the max-bg flag
Created pipeline at 2025-10-14 17:54:57
Running PrimerLocator at 2025-10-14 17:54:57 . . .
. . . done at 2025-10-14 17:54:57
Running FastaFormatChecker at 2025-10-14 17:54:57 . . .
. . . done at 2025-10-14 17:54:57
Running BowtieIndexBuilder at 2025-10-14 17:54:57 . . .
. . . done at 2025-10-14 17:54:57
Running process group 4 at 2025-10-14 17:54:57 . . .
  Including these components:
    ProgressMonitor . . . started at 2025-10-14 17:54:57
    QualityTrimmer1 . . . started at 2025-10-14 17:54:57
    QualityTrimmer2 . . . started at 2025-10-14 17:54:57
    Interleaver . . . started at 2025-10-14 17:54:57
    Merger . . . started at 2025-10-14 17:54:57
    Tab6Interleaver . . . started at 2025-10-14 17:54:57
    BowtieAligner . . . started at 2025-10-14 17:54:57
    MutationParser_Modified . . . started at 2025-10-14 17:54:57
    MutationParserGA_Modified . . . started at 2025-10-14 17:54:57
    MutationCounter_Modified . . . started at 2025-10-14 17:54:57
    MutationCounterGA_Modified . . . started at 2025-10-14 17:54:57
  732KiB [====>                                           ] 12% ETA 0:00:06       1.04MiB [=======>                                        ] 18% ETA 0:00:08      1.35MiB [==========>                                     ] 24% ETA 0:00:09      1.65MiB [============>                                   ] 29% ETA 0:00:09      2.00MiB [===============>                                ] 35% ETA 0:00:09      2.27MiB [==================>                             ] 40% ETA 0:00:08      2.59MiB [=====================>                          ] 46% ETA 0:00:102.60MiB [=====================>                          ] 46% ETA 0:00:10  2.92MiB [=======================>                        ] 52% ETA 0:00:09      3.15MiB [=========================>                      ] 56% ETA 0:00:08      3.39MiB [===========================>                    ] 60% ETA 0:00:09      3.40MiB [===========================>                    ] 60% ETA 0:00:09      3.61MiB [=============================>                  ] 64% ETA 0:00:093.62MiB [=============================>                  ] 64% ETA 0:00:09  3.93MiB [================================>               ] 70% ETA 0:00:07      4.29MiB [===================================>            ] 76% ETA 0:00:05      4.63MiB [======================================>         ] 82% ETA 0:00:04      4.98MiB [=========================================>      ] 88% ETA 0:00:02      5.37MiB [============================================>   ] 95% ETA 0:00:00      5.61MiB [==============================================>] 100%                  /`````````````````````````````````````````````````````````````````````````````
  |Merger (sample: Modified) output message: 
  |----------------------------------------- 
  | 
  | java -Djava.library.path=/gpfs/projects/b1044/Software/shapemapper2-2.3/internals/thirdparty/miniconda/envs/shapemapper_make/opt/bbmap-37.78/jni/ -ea -Xmx1000m -Xmx1000m -cp /gpfs/projects/b1044/Software/shapemapper2-2.3/internals/thirdparty/miniconda/envs/shapemapper_make/opt/bbmap-37.78/current/ jgi.BBMerge vstrict=t in=stdin out=stdout outu=stdout interleaved=t usejni=t t=4
  | Executing jgi.BBMerge [vstrict=t, in=stdin, out=stdout, outu=stdout, interleaved=t, usejni=t, t=4]
  | Version 37.78 [vstrict=t, in=stdin, out=stdout, outu=stdout, interleaved=t, usejni=t, t=4]
  | 
  | Revised arguments: [maxbad=4, margin=3, minqo=8, qualiters=2, ratiomode=t, flatmode=f, minentropy=52, minoverlap=12, minoverlap0=4, maxratio=0.05, ratiomargin=12, ratiooffset=0.5, ratiominoverlapreduction=4, efilter=2, pfilter=0.008, minsecondratio=0.16, minapproxoverlap=22, in=stdin, out=stdout, outu=stdout, interleaved=t, usejni=t, t=4]
  | 
  | Set INTERLEAVED to true
  | Set threads to 4
  | Writing mergable reads merged.
  | Unspecified format for output stdout; defaulting to fastq.
  | Unspecified format for output stdout; defaulting to fastq.
  | Started output threads.
  | Unspecified format for input stdin; defaulting to fastq.
  | Total time: 24.768 seconds.
  | 
  | Pairs:               	262152
  | Joined:              	26279   	10.024%
  | Ambiguous:           	235873   	89.976%
  | No Solution:         	0       	0.000%
  | Too Short:           	0       	0.000%
  | 
  | Avg Insert:          	106.0
  | Standard Deviation:  	0.3
  | Mode:                	106
  | 
  | Insert range:        	96 - 131
  | 90th percentile:     	106
  | 75th percentile:     	106
  | 50th percentile:     	106
  | 25th percentile:     	106
  | 10th percentile:     	106
  \_____________________________________________________________________________
  /`````````````````````````````````````````````````````````````````````````````
  |BowtieAligner (sample: Modified) output message: 
  |------------------------------------------------ 
  | 
  | 262152 reads; of these:
  |   235873 (89.98%) were paired; of these:
  |     221497 (93.91%) aligned concordantly 0 times
  |     14376 (6.09%) aligned concordantly exactly 1 time
  |     0 (0.00%) aligned concordantly >1 times
  |     ----
  |     221497 pairs aligned concordantly 0 times; of these:
  |       0 (0.00%) aligned discordantly 1 time
  |     ----
  |     221497 pairs aligned 0 times concordantly or discordantly; of these:
  |       442994 mates make up the pairs; of these:
  |         221938 (50.10%) aligned 0 times
  |         221039 (49.90%) aligned exactly 1 time
  |         17 (0.00%) aligned >1 times
  |   26279 (10.02%) were unpaired; of these:
  |     0 (0.00%) aligned 0 times
  |     26279 (100.00%) aligned exactly 1 time
  |     0 (0.00%) aligned >1 times
  | 55.44% overall alignment rate
  \_____________________________________________________________________________
  /`````````````````````````````````````````````````````````````````````````````
  |MutationCounter_Modified (RNA: 046-EKC-A8C-75c-b-6-m) (sample: Modified) output message: 
  |---------------------------------------------------------------------------------------- 
  | 
  | Read lengths
  | --------------------
  | bin_range	frequency
  | [0,49]	0.001975
  | [50,99]	0.998025
  | [100,149]	0.000000
  | [150,199]	0.000000
  | [200,249]	0.000000
  | [250,299]	0.000000
  | [300,349]	0.000000
  | [350,399]	0.000000
  | [400,449]	0.000000
  | [450,499]	0.000000
  | [500,549]	0.000000
  | [550,599]	0.000000
  | [600,649]	0.000000
  | [650,699]	0.000000
  | [700,749]	0.000000
  | [750,799]	0.000000
  | [800,849]	0.000000
  | [850,899]	0.000000
  | [900,949]	0.000000
  | [950,999]	0.000000
  | >=1000	0.000000
  | --------------------
  | 
  | Mutations per read
  | --------------------
  | bin_left	frequency
  | 0	0.968339
  | 1	0.031413
  | 2	0.000248
  | 3	0.000000
  | 4	0.000000
  | 5	0.000000
  | 6	0.000000
  | 7	0.000000
  | 8	0.000000
  | 9	0.000000
  | 10	0.000000
  | 11	0.000000
  | 12	0.000000
  | 13	0.000000
  | 14	0.000000
  | 15	0.000000
  | 16	0.000000
  | 17	0.000000
  | 18	0.000000
  | 19	0.000000
  | 20	0.000000
  | --------------------
  \_____________________________________________________________________________
  /`````````````````````````````````````````````````````````````````````````````
  |MutationCounterGA_Modified (RNA: 046-EKC-A8C-75c-b-6-m) (sample: Modified) output message: 
  |------------------------------------------------------------------------------------------ 
  | 
  | Read lengths
  | --------------------
  | bin_range	frequency
  | [0,49]	0.001975
  | [50,99]	0.998025
  | [100,149]	0.000000
  | [150,199]	0.000000
  | [200,249]	0.000000
  | [250,299]	0.000000
  | [300,349]	0.000000
  | [350,399]	0.000000
  | [400,449]	0.000000
  | [450,499]	0.000000
  | [500,549]	0.000000
  | [550,599]	0.000000
  | [600,649]	0.000000
  | [650,699]	0.000000
  | [700,749]	0.000000
  | [750,799]	0.000000
  | [800,849]	0.000000
  | [850,899]	0.000000
  | [900,949]	0.000000
  | [950,999]	0.000000
  | >=1000	0.000000
  | --------------------
  | 
  | Mutations per read
  | --------------------
  | bin_left	frequency
  | 0	0.997123
  | 1	0.002873
  | 2	0.000004
  | 3	0.000000
  | 4	0.000000
  | 5	0.000000
  | 6	0.000000
  | 7	0.000000
  | 8	0.000000
  | 9	0.000000
  | 10	0.000000
  | 11	0.000000
  | 12	0.000000
  | 13	0.000000
  | 14	0.000000
  | 15	0.000000
  | 16	0.000000
  | 17	0.000000
  | 18	0.000000
  | 19	0.000000
  | 20	0.000000
  | --------------------
  \_____________________________________________________________________________
. . . done at 2025-10-14 17:55:22
Running CalcProfile at 2025-10-14 17:55:22 . . .
. . . done at 2025-10-14 17:55:23
Running NormProfile at 2025-10-14 17:55:23 . . .
/```````````````````````````````````````````````````````````````````````````````
|NormProfile (RNA: 046-EKC-A8C-75c-b-6-m) output message: 
|-------------------------------------------------------- 
| 
| Signal for A = 0.000 is below acceptable level. All A nts ignored
| Signal for U = 0.001 is below acceptable level. All U nts ignored
| Signal for G = 0.000 is below acceptable level. All G nts ignored
| calculated normalization factor: {'A': nan, 'C': 0.016326, 'U': nan, 'G': nan}
\_______________________________________________________________________________
. . . done at 2025-10-14 17:55:23
Running CalcProfile at 2025-10-14 17:55:23 . . .
. . . done at 2025-10-14 17:55:23
Running NormProfile at 2025-10-14 17:55:23 . . .
/```````````````````````````````````````````````````````````````````````````````
|NormProfile (RNA: 046-EKC-A8C-75c-b-6-m) output message: 
|-------------------------------------------------------- 
| 
| calculated normalization factor: {'A': nan, 'C': nan, 'U': nan, 'G': 0.00035125, 'GPUR': 0.00033025000000000003, 'GPYR': 0.0005080769230769232}
| ignoring n7 quality check.
\_______________________________________________________________________________
. . . done at 2025-10-14 17:55:23
Running TabToShape at 2025-10-14 17:55:23 . . .
. . . done at 2025-10-14 17:55:24
Running RenderFigures at 2025-10-14 17:55:24 . . .
/```````````````````````````````````````````````````````````````````````````````
|RenderFigures (RNA: 046-EKC-A8C-75c-b-6-m) output message: 
|---------------------------------------------------------- 
| 
| 
| DMS mode quality control checks:
| --------------------------------
| 
| ***************
| *   Nt = A    *
| ***************
| 
| Read depth check:
| 75.0% (9/12) nucleotides meet the minimum read depth of 5000
| FAIL: Read depths are too low for accurate reactivity profile creation.
|       Check alignment stats to see the amount of target sequence present
|       in each sample. Better target enrichment or recovery and/or
|       additional sequencing could help solve this problem.
| 
| Normalized rate check:
| FAIL: No finite normalized rates present.
|       This is either due to the nucleotide failing to
|       pass the normalization factor cutoff of at least
|       0.002 or due to the nucleotide having less than
|       20 nucleotides with quality reactivity information.
|       Please refer to the NormProfile section of this log
|       file for clarification
| 
| 
| ***************
| *   Nt = C    *
| ***************
| 
| Read depth check:
| 100.0% (3/3) nucleotides meet the minimum read depth of 5000
| PASS
| 
| Normalized rate check:
| PASS: Finite normalized rates present.
| 
| 
| ***************
| *   Nt = U    *
| ***************
| 
| Read depth check:
| 100.0% (13/13) nucleotides meet the minimum read depth of 5000
| PASS
| 
| Normalized rate check:
| FAIL: No finite normalized rates present.
|       This is either due to the nucleotide failing to
|       pass the normalization factor cutoff of at least
|       0.002 or due to the nucleotide having less than
|       20 nucleotides with quality reactivity information.
|       Please refer to the NormProfile section of this log
|       file for clarification
| 
| 
| ***************
| *   Nt = G    *
| ***************
| 
| Read depth check:
| 83.3% (10/12) nucleotides meet the minimum read depth of 5000
| PASS
| 
| Normalized rate check:
| FAIL: No finite normalized rates present.
|       This is either due to the nucleotide failing to
|       pass the normalization factor cutoff of at least
|       0.002 or due to the nucleotide having less than
|       20 nucleotides with quality reactivity information.
|       Please refer to the NormProfile section of this log
|       file for clarification
| 
| 
| -----------------------------------------------------------------
| 
|       Nucleotide passes all quality control checks: 
|         A: False
|         C: True
|         U: False
|         G: False
| 
| 
|       G and/or U FAILURE, but other reactivities may be usable
|       Possible causes:
|        - improper pH control during DMS reaction
|        - use of a different RT enzyme than MarathonRT
|        - poor reverse transcription conditions, resulting
|          in low adduct adduct read-through or detection
|        - very highly structured or protein bound RNA
| 
\_______________________________________________________________________________
. . . done at 2025-10-14 17:55:26
Running RenderMappedDepths at 2025-10-14 17:55:26 . . .
/```````````````````````````````````````````````````````````````````````````````
|RenderMappedDepths (RNA: 046-EKC-A8C-75c-b-6-m) output message: 
|--------------------------------------------------------------- 
| 
| Approximate maximum read depth for reads mapping near each amplicon primer pair
| (See *_mapped_depths.pdf for plots)
| (See *_per-amplicon_abundance.txt for exact numbers)
| 
| Modified:
|   pair forward                       left    right   reverse                       left    right   depth  
|   ---- ----------------------------- ------- ------- ----------------------------- ------- ------- ------ 
|   1    GGTGTAAGGGTGAAGTGTA           0       18      CTTCACCTTCATTACCTTTA          60      79      262k   
| 
\_______________________________________________________________________________
. . . done at 2025-10-14 17:55:27
ShapeMapper run completed at 2025-10-14 17:55:27.
WARNING: This RNA has a possible poor quality reactivity profile: 046-EKC-A8C-75c-b-6-m
See quality control checks above for details.
Deleting temp files. Use --output-temp to retain temp files.
